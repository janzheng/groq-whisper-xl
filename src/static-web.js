// Embedded static files for the web interface
// This file is auto-generated by scripts/build-static.js - do not edit manually!

export const STATIC_FILES = {
  '/': `<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Groq Whisper XL - Audio Transcription</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.js"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              'terminal-bg': '#fff8eb',
              'terminal-bg-light': '#ffffff',
              'terminal-text': '#27231f',
              'terminal-text-dim': '#6b6356',
              'terminal-accent': '#27231f',
              'terminal-border': '#432f0d',
              'status-success': '#16a34a',
              'status-error': '#dc2626',
              'status-warning': '#d97706',
              'status-info': '#2563eb',
            }
          }
        }
      }
    </script>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Inter', 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
      }
      
      @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.5; }
      }
      
      .animate-pulse-slow {
        animation: pulse 2s infinite;
      }
      
      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }
      
      .animate-fade-in {
        animation: fadeIn 0.3s ease-in;
      }
      
      @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
      }
      
      .animate-spin {
        animation: spin 1s linear infinite;
      }
    </style>
    <script type="module" src="/assets/app.js"></script>
  </head>
  <body class="bg-terminal-bg text-terminal-text overflow-x-hidden">
    <div id="app"></div>
  </body>
</html> `,
  
  '/assets/app.js': `var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function r(e){e.forEach(t)}function i(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function s(t,...n){if(null==t){for(const e of n)e(void 0);return e}const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function l(e){let t;return s(e,e=>t=e)(),t}function a(e,t,n){e.$$.on_destroy.push(s(t,n))}function c(e,t,n){return e.set(n),t}function d(e,t){e.appendChild(t)}function u(e,t,n){e.insertBefore(t,n||null)}function m(e){e.parentNode&&e.parentNode.removeChild(e)}function p(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function f(e){return document.createElement(e)}function b(e){return document.createTextNode(e)}function g(){return b(" ")}function h(){return b("")}function x(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function _(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function y(e,t,n){const r=t.toLowerCase();r in e?e[r]="boolean"==typeof e[r]&&""===n||n:t in e?e[t]="boolean"==typeof e[t]&&""===n||n:_(e,t,n)}function v(e,t){t=""+t,e.data!==t&&(e.data=t)}function w(e,t){e.value=null==t?"":t}function k(e,t,n,r){null==n?e.style.removeProperty(t):e.style.setProperty(t,n,"")}function $(e,t,n){for(let n=0;n<e.options.length;n+=1){const r=e.options[n];if(r.__value===t)return void(r.selected=!0)}n&&void 0===t||(e.selectedIndex=-1)}function j(e){const t=e.querySelector(":checked");return t&&t.__value}function S(e,t,n){e.classList.toggle(t,!!n)}let C;function T(e){C=e}function L(){if(!C)throw new Error("Function called outside component initialization");return C}function M(e){L().$$.on_mount.push(e)}function E(){const e=L();return(t,n,{cancelable:r=!1}={})=>{const i=e.$$.callbacks[t];if(i){const o=function(e,t,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:r})}(t,n,{cancelable:r});return i.slice().forEach(t=>{t.call(e,o)}),!o.defaultPrevented}return!0}}const z=[],O=[];let A=[];const F=[],D=Promise.resolve();let I=!1;function U(e){A.push(e)}const P=new Set;let R=0;function N(){if(0!==R)return;const e=C;do{try{for(;R<z.length;){const e=z[R];R++,T(e),B(e.$$)}}catch(e){throw z.length=0,R=0,e}for(T(null),z.length=0,R=0;O.length;)O.pop()();for(let e=0;e<A.length;e+=1){const t=A[e];P.has(t)||(P.add(t),t())}A.length=0}while(z.length);for(;F.length;)F.pop()();I=!1,P.clear(),T(e)}function B(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(U)}}const J=new Set;let W;function G(){W={r:0,c:[],p:W}}function H(){W.r||r(W.c),W=W.p}function q(e,t){e&&e.i&&(J.delete(e),e.i(t))}function V(e,t,n,r){if(e&&e.o){if(J.has(e))return;J.add(e),W.c.push(()=>{J.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}else r&&r()}function K(e){return void 0!==e?.length?e:Array.from(e)}function X(e,t){V(e,1,1,()=>{t.delete(e.key)})}function Q(e){e&&e.c()}function Y(e,n,o){const{fragment:s,after_update:l}=e.$$;s&&s.m(n,o),U(()=>{const n=e.$$.on_mount.map(t).filter(i);e.$$.on_destroy?e.$$.on_destroy.push(...n):r(n),e.$$.on_mount=[]}),l.forEach(U)}function Z(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];A.forEach(r=>-1===e.indexOf(r)?t.push(r):n.push(r)),n.forEach(e=>e()),A=t}(n.after_update),r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ee(e,t){-1===e.$$.dirty[0]&&(z.push(e),I||(I=!0,D.then(N)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function te(t,i,o,s,l,a,c=null,d=[-1]){const u=C;T(t);const p=t.$$={fragment:null,ctx:[],props:a,update:e,not_equal:l,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(i.context||(u?u.$$.context:[])),callbacks:n(),dirty:d,skip_bound:!1,root:i.target||u.$$.root};c&&c(p.root);let f=!1;if(p.ctx=o?o(t,i.props||{},(e,n,...r)=>{const i=r.length?r[0]:n;return p.ctx&&l(p.ctx[e],p.ctx[e]=i)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](i),f&&ee(t,e)),n}):[],p.update(),f=!0,r(p.before_update),p.fragment=!!s&&s(p.ctx),i.target){if(i.hydrate){const e=function(e){return Array.from(e.childNodes)}(i.target);p.fragment&&p.fragment.l(e),e.forEach(m)}else p.fragment&&p.fragment.c();i.intro&&q(t.$$.fragment),Y(t,i.target,i.anchor),N()}T(u)}class ne{$$=void 0;$$set=void 0;$destroy(){Z(this,1),this.$destroy=e}$on(t,n){if(!i(n))return e;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const e=r.indexOf(n);-1!==e&&r.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function re(t){let n;return{c(){n=f("div"),n.innerHTML='<div class="flex items-center gap-2 text-lg font-bold"><iconify-icon icon="mdi:lightning-bolt" class="text-terminal-accent"></iconify-icon> <span class="text-terminal-accent">Groq Whisper XL</span></div> <div class="text-terminal-text-dim mt-2">Fast, accurate audio transcription powered by Groq&#39;s Whisper API with intelligent chunking and LLM enhancement.</div> <div class="mt-3"><div class="space-y-1 text-sm"><div class="flex items-center gap-2 text-terminal-text-dim"><iconify-icon icon="mdi:file-music" class="text-xs"></iconify-icon> <span>Universal file support up to 1GB with smart processing</span></div> <div class="flex items-center gap-2 text-terminal-text-dim"><iconify-icon icon="mdi:brain" class="text-xs"></iconify-icon> <span>AI-powered error correction for improved accuracy</span></div> <div class="flex items-center gap-2 text-terminal-text-dim"><iconify-icon icon="mdi:play-speed" class="text-xs"></iconify-icon> <span>Real-time streaming transcription with live results</span></div></div></div>',_(n,"class","border-2 border-terminal-border bg-terminal-bg-light p-4 mb-4")},m(e,t){u(e,n,t)},p:e,i:e,o:e,d(e){e&&m(n)}}}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");class ie extends ne{constructor(e){super(),te(this,e,null,re,o,{})}}const oe=[];function se(t,n=e){let r;const i=new Set;function s(e){if(o(t,e)&&(t=e,r)){const e=!oe.length;for(const e of i)e[1](),oe.push(e,t);if(e){for(let e=0;e<oe.length;e+=2)oe[e][0](oe[e+1]);oe.length=0}}}function l(e){s(e(t))}return{set:s,update:l,subscribe:function(o,a=e){const c=[o,a];return i.add(c),1===i.size&&(r=n(s,l)||e),o(t),()=>{i.delete(c),0===i.size&&r&&(r(),r=null)}}}}class le{static levels={DEBUG:0,INFO:1,WARN:2,ERROR:3};static emojis={start:"🚀",processing:"🔄",complete:"✅",failed:"❌",upload:"📤",download:"📥",file:"📁",delete:"🗑️",audio:"🎵",transcribe:"🎤",chunk:"🧩",stream:"🌊",llm:"🧠",api:"📡",webhook:"🔗",url:"🌐",info:"ℹ️",warning:"⚠️",error:"❌",debug:"🔍",stats:"📊",time:"⏱️",progress:"📈"};constructor(e="WEB",t=le.levels.INFO){this.context=e,this.level=t}_formatMessage(e,t,n=null){(new Date).toLocaleTimeString();const r=\`\${e} [\${this.context}]\`;return n&&Object.keys(n).length,\`\${r} \${t}\`}debug(e,t=null){if(this.level<=le.levels.DEBUG){const n=this._formatMessage(le.emojis.debug,e,t);console.log(n,t)}}info(e,t,n=null){if(this.level<=le.levels.INFO){const r=le.emojis[e]||e,i=this._formatMessage(r,t,n);console.log(i,n)}}warn(e,t=null){if(this.level<=le.levels.WARN){const n=this._formatMessage(le.emojis.warning,e,t);console.warn(n,t)}}error(e,t=null,n=null){if(this.level<=le.levels.ERROR){const r=this._formatMessage(le.emojis.error,e,n);console.error(r,t,n)}}upload(e,t=null){this.info("upload",e,t)}download(e,t=null){this.info("download",e,t)}processing(e,t=null){this.info("processing",e,t)}complete(e,t=null){this.info("complete",e,t)}chunk(e,t=null){this.info("chunk",e,t)}transcribe(e,t=null){this.info("transcribe",e,t)}llm(e,t=null){this.info("llm",e,t)}api(e,t=null){this.info("api",e,t)}stats(e,t=null){this.info("stats",e,t)}stream(e,t=null){this.info("stream",e,t)}}const ae=new le("WEB",le.levels.INFO),ce=new le("STREAM",le.levels.INFO),de=se([]),ue=se(!1),me=se(!1),pe=se(!1),fe=se(""),be=se(Date.now()),ge=se(0),he=se(""),xe=se(0),_e=se(0),ye=se(""),ve=se("disabled"),we=se(!1),ke=se(!1),$e=se(!1),je=se([]),Se=se("speed"),Ce=se({upload:0,processing:0,overall:0}),Te=se(""),Le=se(""),Me=se(0),Ee=se(0),ze=se(0),Oe=se(0),Ae=se(0),Fe="";function De(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","GB"][t]}let Ie=0;function Ue(e,t){je.update(n=>{if(n[e]){const r={...n[e],...t};"complete"===t.status&&"complete"!==n[e].status&&(r.completedAt=(new Date).toISOString(),r.arrivalOrder=Ie++),n[e]=r}return[...n]})}async function Pe(){try{console.log("=== FETCH JOBS CALLED ===");const e=l(de);console.log("Jobs before fetch:",e.length,e.map(e=>({id:e.job_id.slice(0,8)+"...",method:e.processing_method})));const t=await fetch("/jobs");if(t.ok){const n=(await t.json()).jobs||[];console.log("Server returned jobs:",n.length,n.map(e=>({id:e.job_id.slice(0,8)+"...",method:e.processing_method||"direct"})));const r=new Set(e.map(e=>e.job_id)),i=n.filter(e=>!r.has(e.job_id));console.log("New server jobs to add:",i.length,i.map(e=>({id:e.job_id.slice(0,8)+"...",method:e.processing_method||"direct"})));const o=[];for(const t of e){const e=n.find(e=>e.job_id===t.job_id);e?o.push({...t,...e,..."streaming"===t.processing_method?{raw_transcript:t.raw_transcript||e.raw_transcript,corrected_transcript:t.corrected_transcript||e.corrected_transcript,final_transcript:t.final_transcript||e.final_transcript,transcripts:t.transcripts||e.transcripts||[]}:{}}):o.push(t)}const s=[...o,...i],l=[],a=new Set;for(const e of s)a.has(e.job_id)||(a.add(e.job_id),l.push(e));de.set(l),console.log("Jobs after fetch and deduplication:",l.length,l.map(e=>({id:e.job_id.slice(0,8)+"...",method:e.processing_method}))),ae.info("api","Fetched jobs",{server_jobs:n.length,new_server_jobs:i.length,local_jobs_preserved:e.length,total:l.length,duplicates_removed:s.length-l.length})}}catch(e){console.error("Fetch jobs error:",e),ae.error("Failed to fetch jobs",e)}}function Re(e){let t,n,r;return{c(){t=f("input"),_(t,"class","bg-terminal-bg-light border border-terminal-border text-terminal-text px-3 py-2 w-full focus:outline-none focus:border-terminal-accent"),_(t,"type","url"),_(t,"placeholder","https://example.com/audio.mp3")},m(i,o){u(i,t,o),w(t,e[1]),n||(r=x(t,"input",e[20]),n=!0)},p(e,n){2&n&&t.value!==e[1]&&w(t,e[1])},d(e){e&&m(t),n=!1,r()}}}function Ne(e){let t,n,i,o,s,l,a,c,p,h,w,k,$,j,C=e[6].title+"",T=e[6].subtitle+"",L=e[6].description&&Be(e);return{c(){t=f("div"),n=f("iconify-icon"),o=g(),s=f("div"),l=b(C),a=g(),c=f("div"),p=b(T),h=g(),L&&L.c(),w=g(),k=f("input"),y(n,"icon",i=e[6].icon),y(n,"class","text-3xl mb-2"),S(n,"text-terminal-text-dim",!e[6].success&&!e[6].error),S(n,"text-terminal-accent","mdi:file-music"===e[6].icon),S(n,"animate-spin","mdi:loading"===e[6].icon),_(s,"class","font-bold"),_(c,"class","text-xs"),S(c,"text-terminal-text-dim",!e[6].success&&!e[6].error),S(c,"text-terminal-accent","mdi:file-music"===e[6].icon),_(t,"role","button"),_(t,"tabindex","0"),_(t,"class","border-2 border-dashed border-terminal-border p-6 text-center cursor-pointer transition-all hover:border-terminal-accent hover:bg-gray-900/20"),S(t,"text-status-success",e[6].success),S(t,"text-status-error",e[6].error),_(k,"type","file"),_(k,"accept","audio/*,video/*"),_(k,"class","hidden")},m(r,i){u(r,t,i),d(t,n),d(t,o),d(t,s),d(s,l),d(t,a),d(t,c),d(c,p),d(t,h),L&&L.m(t,null),e[17](t),u(r,w,i),u(r,k,i),e[19](k),$||(j=[x(t,"click",e[12]),x(t,"keydown",e[18]),x(t,"dragover",e[8]),x(t,"dragleave",e[9]),x(t,"drop",e[10]),x(k,"change",e[11])],$=!0)},p(e,r){64&r&&i!==(i=e[6].icon)&&y(n,"icon",i),64&r&&S(n,"text-terminal-text-dim",!e[6].success&&!e[6].error),64&r&&S(n,"text-terminal-accent","mdi:file-music"===e[6].icon),64&r&&S(n,"animate-spin","mdi:loading"===e[6].icon),64&r&&C!==(C=e[6].title+"")&&v(l,C),64&r&&T!==(T=e[6].subtitle+"")&&v(p,T),64&r&&S(c,"text-terminal-text-dim",!e[6].success&&!e[6].error),64&r&&S(c,"text-terminal-accent","mdi:file-music"===e[6].icon),e[6].description?L?L.p(e,r):(L=Be(e),L.c(),L.m(t,null)):L&&(L.d(1),L=null),64&r&&S(t,"text-status-success",e[6].success),64&r&&S(t,"text-status-error",e[6].error)},d(n){n&&(m(t),m(w),m(k)),L&&L.d(),e[17](null),e[19](null),$=!1,r(j)}}}function Be(e){let t,n,r=e[6].description+"";return{c(){t=f("div"),n=b(r),_(t,"class","text-xs text-terminal-text-dim")},m(e,r){u(e,t,r),d(t,n)},p(e,t){64&t&&r!==(r=e[6].description+"")&&v(n,r)},d(e){e&&m(t)}}}function Je(e){let t;return{c(){t=b("Transcribe Audio")},m(e,n){u(e,t,n)},d(e){e&&m(t)}}}function We(e){let t;return{c(){t=b("Processing...")},m(e,n){u(e,t,n)},d(e){e&&m(t)}}}function Ge(t){let n,i,o,s,l,a,c,p,b,h,v,k,$,j,C,T,L,M,E,z,O,A,F,D,I,U,P,R,N,B,J,W,G,H,q,V,K,X;function Q(e,t){return"file"===e[0]?Ne:Re}let Y=Q(t),Z=Y(t);function ee(e,t){return e[7]?We:Je}let te=ee(t),ne=te(t);return{c(){n=f("div"),i=f("div"),i.innerHTML='<iconify-icon icon="mdi:microphone" class="text-lg"></iconify-icon> <span>Direct Transcription</span>',o=g(),s=f("div"),s.textContent="Upload files or URLs for complete transcription. Results available when processing is done.",l=g(),a=f("div"),c=f("div"),c.textContent="Source:",p=g(),b=f("div"),h=f("button"),h.innerHTML='<iconify-icon icon="mdi:file-outline"></iconify-icon> File',v=g(),k=f("button"),k.innerHTML='<iconify-icon icon="mdi:web"></iconify-icon> URL',$=g(),Z.c(),j=g(),C=f("div"),T=f("div"),T.textContent="Settings:",L=g(),M=f("div"),E=f("div"),z=f("label"),O=f("input"),A=g(),F=f("iconify-icon"),D=g(),I=f("span"),I.textContent="LLM Error Correction",U=g(),P=f("span"),P.textContent="(Improves accuracy)",R=g(),N=f("div"),B=f("label"),B.textContent="Webhook URL (optional):",J=g(),W=f("input"),G=g(),H=f("button"),q=f("iconify-icon"),V=g(),ne.c(),_(i,"class","flex items-center gap-2 mb-4 font-bold text-terminal-accent"),_(s,"class","text-xs text-terminal-text-dim mb-4"),_(c,"class","font-bold mb-2"),_(h,"class","border border-terminal-border text-terminal-text px-4 py-2 hover:bg-yellow-400 transition-colors flex-1 flex items-center justify-center gap-2"),S(h,"bg-yellow-400","file"===t[0]),S(h,"bg-terminal-bg","file"!==t[0]),_(k,"class","border border-terminal-border text-terminal-text px-4 py-2 hover:bg-yellow-400 transition-colors flex-1 flex items-center justify-center gap-2"),S(k,"bg-yellow-400","url"===t[0]),S(k,"bg-terminal-bg","url"!==t[0]),_(b,"class","flex gap-2 mb-3"),_(a,"class","mb-4"),_(T,"class","font-bold mb-2"),_(O,"type","checkbox"),_(O,"class","w-4 h-4"),y(F,"icon","mdi:brain"),y(F,"class","text-terminal-accent"),_(I,"class","text-terminal-accent"),_(P,"class","text-terminal-text-dim"),_(z,"class","flex items-center gap-2 cursor-pointer"),_(B,"for","webhook-url"),_(B,"class","text-terminal-text-dim block mb-1"),_(W,"id","webhook-url"),_(W,"class","bg-terminal-bg-light border border-terminal-border text-terminal-text px-3 py-2 w-full focus:outline-none focus:border-terminal-accent"),_(W,"type","url"),_(W,"placeholder","https://your-webhook.com/endpoint"),_(M,"class","space-y-3"),_(C,"class","mb-4 flex-1"),y(q,"icon","mdi:microphone"),H.disabled=t[7],_(H,"class","bg-terminal-accent text-terminal-bg px-4 py-2 hover:bg-gray-700 transition-colors w-full font-bold flex items-center justify-center gap-2"),S(H,"opacity-50",t[7]),_(n,"class","border border-terminal-border p-4 flex flex-col")},m(e,r){u(e,n,r),d(n,i),d(n,o),d(n,s),d(n,l),d(n,a),d(a,c),d(a,p),d(a,b),d(b,h),d(b,v),d(b,k),d(a,$),Z.m(a,null),d(n,j),d(n,C),d(C,T),d(C,L),d(C,M),d(M,E),d(E,z),d(z,O),O.checked=t[2],d(z,A),d(z,F),d(z,D),d(z,I),d(z,U),d(z,P),d(M,R),d(M,N),d(N,B),d(N,J),d(N,W),w(W,t[3]),d(n,G),d(n,H),d(H,q),d(H,V),ne.m(H,null),K||(X=[x(h,"click",t[15]),x(k,"click",t[16]),x(O,"change",t[21]),x(W,"input",t[22]),x(H,"click",t[13])],K=!0)},p(e,[t]){1&t&&S(h,"bg-yellow-400","file"===e[0]),1&t&&S(h,"bg-terminal-bg","file"!==e[0]),1&t&&S(k,"bg-yellow-400","url"===e[0]),1&t&&S(k,"bg-terminal-bg","url"!==e[0]),Y===(Y=Q(e))&&Z?Z.p(e,t):(Z.d(1),Z=Y(e),Z&&(Z.c(),Z.m(a,null))),4&t&&(O.checked=e[2]),8&t&&W.value!==e[3]&&w(W,e[3]),te!==(te=ee(e))&&(ne.d(1),ne=te(e),ne&&(ne.c(),ne.m(H,null))),128&t&&(H.disabled=e[7]),128&t&&S(H,"opacity-50",e[7])},i:e,o:e,d(e){e&&m(n),Z.d(),ne.d(),K=!1,r(X)}}}function He(e,t,n){let r;a(e,ue,e=>n(7,r=e));let i,o,s="file",d=null,u="",m=!1,p="",f={icon:"mdi:file-plus",title:"Drop files here or click to browse",subtitle:"MP3, WAV, M4A, FLAC, etc. (up to 1GB)"};function b(e){n(6,f={icon:"mdi:file-music",title:e.name,subtitle:\`Ready to transcribe (\${De(e.size)})\`,description:'Click "Transcribe Audio" to start'}),d=e}function g(){n(6,f={icon:"mdi:file-plus",title:"Drop files here or click to browse",subtitle:"MP3, WAV, M4A, FLAC, etc. (up to 1GB)"}),d=null,o&&n(5,o.value="",o)}function h(){i&&(i.classList.remove("border-terminal-accent","bg-green-900/20"),i.classList.add("border-terminal-border"))}function x(){o&&o.click()}function _(e){n(0,s=e),g(),n(1,u="")}return[s,u,m,p,i,o,f,r,function(e){e.preventDefault(),i&&(i.classList.add("border-terminal-accent","bg-green-900/20"),i.classList.remove("border-terminal-border"))},h,function(e){e.preventDefault(),h();const t=Array.from(e.dataTransfer.files);t.length>0&&b(t[0])},function(e){const t=Array.from(e.target.files);t.length>0&&b(t[0])},x,async function(){if(!r)if("file"===s)if(d)try{c(ue,r=!0,r),n(6,f={icon:"mdi:upload",title:\`Uploading \${d.name}...\`,subtitle:\`\${De(d.size)} - Please wait\`}),await new Promise(e=>setTimeout(e,300)),n(6,f={icon:"mdi:loading",title:\`Processing \${d.name}...\`,subtitle:"Transcribing audio with Groq Whisper"}),await async function(e,t,n){const r=new FormData;r.append("file",e),r.append("use_llm",t.toString()),n&&r.append("webhook_url",n);const i=await fetch("/upload",{method:"POST",body:r});if(i.ok){const e=await i.json(),n=l(de),r={job_id:e.job_id,filename:e.filename,status:"processing",file_size:e.file_size,processing_method:e.processing_method,upload_method:"direct",use_llm:t,created_at:(new Date).toISOString()};return de.set([r,...n]),e}{const e=await i.json();throw new Error(e.error||"Upload failed")}}(d,m,p||null),n(6,f={icon:"mdi:check",title:\`\${d.name} uploaded successfully!\`,subtitle:'Check "Jobs" section for progress',success:!0}),setTimeout(()=>{g()},3e3)}catch(e){n(6,f={icon:"mdi:alert-circle",title:"Upload failed",subtitle:e.message,error:!0}),setTimeout(()=>{g()},3e3)}finally{c(ue,r=!1,r)}else x();else if("url"===s)if(u.trim())try{c(ue,r=!0,r),await async function(e,t,n){const r={url:e,use_llm:t};n&&(r.webhook_url=n);const i=await fetch("/upload-url",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(i.ok){const e=await i.json(),n=l(de),r={job_id:e.job_id,filename:e.filename,status:"processing",file_size:e.file_size,processing_method:e.processing_method,upload_method:"url",source_url:e.source_url,use_llm:t,created_at:(new Date).toISOString()};return de.set([r,...n]),e}{const e=await i.json();throw new Error(e.error||"URL upload failed")}}(u.trim(),m,p||null),n(1,u="")}catch(e){alert("Upload failed: "+e.message)}finally{c(ue,r=!1,r)}else alert("Please enter an audio URL first")},_,()=>_("file"),()=>_("url"),function(e){O[e?"unshift":"push"](()=>{i=e,n(4,i)})},e=>"Enter"===e.key&&x(),function(e){O[e?"unshift":"push"](()=>{o=e,n(5,o)})},function(){u=this.value,n(1,u)},function(){m=this.checked,n(2,m)},function(){p=this.value,n(3,p)}]}class qe extends ne{constructor(e){super(),te(this,e,He,Ge,o,{})}}function Ve(e){let t,n,r,i;return{c(){t=f("input"),t.disabled=n=e[8]||e[9],_(t,"class","bg-terminal-bg-light border border-terminal-border text-terminal-text px-3 py-2 w-full focus:outline-none focus:border-terminal-accent"),_(t,"type","url"),_(t,"placeholder","https://example.com/audio.mp3"),S(t,"opacity-50",e[8]||e[9])},m(n,o){u(n,t,o),w(t,e[1]),r||(i=x(t,"input",e[26]),r=!0)},p(e,r){768&r[0]&&n!==(n=e[8]||e[9])&&(t.disabled=n),2&r[0]&&t.value!==e[1]&&w(t,e[1]),768&r[0]&&S(t,"opacity-50",e[8]||e[9])},d(e){e&&m(t),r=!1,i()}}}function Ke(e){let t,n,i,o,s,l,a,c,p,h,w,k,$,j,C,T=e[7].title+"",L=e[7].subtitle+"",M=e[7].description&&Xe(e);return{c(){t=f("div"),n=f("iconify-icon"),o=g(),s=f("div"),l=b(T),a=g(),c=f("div"),p=b(L),h=g(),M&&M.c(),w=g(),k=f("input"),y(n,"icon",i=e[7].icon),y(n,"class","text-3xl mb-2"),S(n,"text-terminal-text-dim",!e[7].success&&!e[7].error),S(n,"text-terminal-accent","mdi:file-music"===e[7].icon),S(n,"animate-spin","mdi:loading"===e[7].icon),_(s,"class","font-bold"),_(c,"class","text-xs"),S(c,"text-terminal-text-dim",!e[7].success&&!e[7].error),S(c,"text-terminal-accent","mdi:file-music"===e[7].icon),_(t,"role","button"),_(t,"tabindex","0"),_(t,"class","border-2 border-dashed border-terminal-border p-6 text-center cursor-pointer transition-all hover:border-terminal-accent hover:bg-gray-900/20"),S(t,"pointer-events-none",e[8]||e[9]),S(t,"opacity-50",e[8]||e[9]),_(k,"type","file"),_(k,"accept","audio/*,video/*"),_(k,"class","hidden"),k.disabled=$=e[8]||e[9]},m(r,i){u(r,t,i),d(t,n),d(t,o),d(t,s),d(s,l),d(t,a),d(t,c),d(c,p),d(t,h),M&&M.m(t,null),e[23](t),u(r,w,i),u(r,k,i),e[25](k),j||(C=[x(t,"click",e[15]),x(t,"keydown",e[24]),x(t,"dragover",e[11]),x(t,"dragleave",e[12]),x(t,"drop",e[13]),x(k,"change",e[14])],j=!0)},p(e,r){128&r[0]&&i!==(i=e[7].icon)&&y(n,"icon",i),128&r[0]&&S(n,"text-terminal-text-dim",!e[7].success&&!e[7].error),128&r[0]&&S(n,"text-terminal-accent","mdi:file-music"===e[7].icon),128&r[0]&&S(n,"animate-spin","mdi:loading"===e[7].icon),128&r[0]&&T!==(T=e[7].title+"")&&v(l,T),128&r[0]&&L!==(L=e[7].subtitle+"")&&v(p,L),128&r[0]&&S(c,"text-terminal-text-dim",!e[7].success&&!e[7].error),128&r[0]&&S(c,"text-terminal-accent","mdi:file-music"===e[7].icon),e[7].description?M?M.p(e,r):(M=Xe(e),M.c(),M.m(t,null)):M&&(M.d(1),M=null),768&r[0]&&S(t,"pointer-events-none",e[8]||e[9]),768&r[0]&&S(t,"opacity-50",e[8]||e[9]),768&r[0]&&$!==($=e[8]||e[9])&&(k.disabled=$)},d(n){n&&(m(t),m(w),m(k)),M&&M.d(),e[23](null),e[25](null),j=!1,r(C)}}}function Xe(e){let t,n,r=e[7].description+"";return{c(){t=f("div"),n=b(r),_(t,"class","text-xs text-terminal-text-dim")},m(e,r){u(e,t,r),d(t,n)},p(e,t){128&t[0]&&r!==(r=e[7].description+"")&&v(n,r)},d(e){e&&m(t)}}}function Qe(e){let t;return{c(){t=b("Real-time streaming for immediate feedback")},m(e,n){u(e,t,n)},d(e){e&&m(t)}}}function Ye(e){let t;return{c(){t=b("Large files uploaded in chunks with parallel processing")},m(e,n){u(e,t,n)},d(e){e&&m(t)}}}function Ze(e){let t,n,r,i,o,s,l,a;return{c(){t=f("select"),n=f("option"),n.textContent="0.25MB (Ultra-fast)",r=f("option"),r.textContent="0.5MB (Fast)",i=f("option"),i.textContent="1MB (Balanced)",o=f("option"),o.textContent="2MB (Fewer API calls)",n.__value=.25,w(n,n.__value),r.__value=.5,w(r,r.__value),i.__value=1,w(i,i.__value),o.__value=2,w(o,o.__value),_(t,"id","chunk-size"),t.disabled=s=e[8]||e[9],_(t,"class","bg-terminal-bg-light border border-terminal-border text-terminal-text px-3 py-2 w-full focus:outline-none focus:border-terminal-accent"),void 0===e[2]&&U(()=>e[30].call(t)),S(t,"opacity-50",e[8]||e[9])},m(s,c){u(s,t,c),d(t,n),d(t,r),d(t,i),d(t,o),$(t,e[2],!0),l||(a=x(t,"change",e[30]),l=!0)},p(e,n){768&n[0]&&s!==(s=e[8]||e[9])&&(t.disabled=s),4&n[0]&&$(t,e[2]),768&n[0]&&S(t,"opacity-50",e[8]||e[9])},d(e){e&&m(t),l=!1,a()}}}function et(e){let t,n,r,i,o,s,l,a;return{c(){t=f("select"),n=f("option"),n.textContent="5MB (Recommended)",r=f("option"),r.textContent="10MB (Fewer chunks)",i=f("option"),i.textContent="20MB (Very large chunks)",o=f("option"),o.textContent="50MB (Maximum size)",n.__value=5,w(n,n.__value),r.__value=10,w(r,r.__value),i.__value=20,w(i,i.__value),o.__value=50,w(o,o.__value),_(t,"id","chunked-chunk-size"),t.disabled=s=e[8]||e[9],_(t,"class","bg-terminal-bg-light border border-terminal-border text-terminal-text px-3 py-2 w-full focus:outline-none focus:border-terminal-accent"),void 0===e[3]&&U(()=>e[29].call(t)),S(t,"opacity-50",e[8]||e[9])},m(s,c){u(s,t,c),d(t,n),d(t,r),d(t,i),d(t,o),$(t,e[3],!0),l||(a=x(t,"change",e[29]),l=!0)},p(e,n){768&n[0]&&s!==(s=e[8]||e[9])&&(t.disabled=s),8&n[0]&&$(t,e[3]),768&n[0]&&S(t,"opacity-50",e[8]||e[9])},d(e){e&&m(t),l=!1,a()}}}function tt(e){let t;return{c(){t=f("iconify-icon"),y(t,"icon","mdi:waveform")},m(e,n){u(e,t,n)},d(e){e&&m(t)}}}function nt(e){let t,n;return{c(){t=f("iconify-icon"),n=b(" Stop Streaming"),y(t,"icon","mdi:stop")},m(e,r){u(e,t,r),u(e,n,r)},d(e){e&&(m(t),m(n))}}}function rt(t){let n;return{c(){n=b("Stop Streaming")},m(e,t){u(e,n,t)},p:e,d(e){e&&m(n)}}}function it(t){let n,r=t[17]()+"";return{c(){n=b(r)},m(e,t){u(e,n,t)},p:e,d(e){e&&m(n)}}}function ot(t){let n,o,s,l,a,c,p,h,k,j,C,T,L,M,E,z,O,A,F,D,I,P,R,N,B,J,W,G,H,q,V,K,X,Q,Y,Z,ee,te,ne,re,ie,oe,se,le,ae,ce,de,ue,me,pe,fe,be,ge,he,xe,_e,ye,ve,we=t[10]?"Upload chunk size:":"Chunk size:";function ke(e,t){return"file"===e[0]?Ke:Ve}let $e=ke(t),je=$e(t);function Se(e,t){return e[10]?Ye:Qe}let Ce=Se(t),Te=Ce(t);function Le(e,t){return e[10]?et:Ze}let Me=Le(t),Ee=Me(t);function ze(e,t){return e[8]||e[9]?nt:tt}let Oe=ze(t),Ae=Oe(t);function Fe(e,t){return e[8]||e[9]?rt:it}let De=Fe(t),Ie=De(t);return{c(){n=f("div"),o=f("div"),o.innerHTML='<iconify-icon icon="mdi:waveform" class="text-lg"></iconify-icon> <span>Streaming Transcription</span>',s=g(),l=f("div"),l.textContent="Real-time processing with live transcript streaming. See results as they're generated - perfect for demos and testing.",a=g(),c=f("div"),p=f("div"),p.textContent="Source:",h=g(),k=f("div"),j=f("button"),C=f("iconify-icon"),T=b(" File"),M=g(),E=f("button"),z=f("iconify-icon"),O=b(" URL"),F=g(),je.c(),D=g(),I=f("div"),P=f("div"),P.textContent="Settings:",R=g(),N=f("div"),B=f("div"),J=f("label"),J.textContent="Streaming mode:",W=g(),G=f("div"),H=f("button"),q=f("iconify-icon"),V=b(" Live Streaming"),X=g(),Q=f("button"),Y=f("iconify-icon"),Z=b(" Chunked Upload"),te=g(),ne=f("div"),Te.c(),re=g(),ie=f("div"),oe=f("label"),se=b(we),le=g(),Ee.c(),ae=g(),ce=f("div"),de=f("label"),de.textContent="LLM correction:",ue=g(),me=f("select"),pe=f("option"),pe.textContent="Disabled (fastest)",fe=f("option"),fe.textContent="Per-chunk (real-time)",be=f("option"),be.textContent="Post-process (better quality)",he=g(),xe=f("button"),Ae.c(),_e=g(),Ie.c(),_(o,"class","flex items-center gap-2 mb-4 font-bold text-terminal-accent"),_(l,"class","text-xs text-terminal-text-dim mb-4"),_(p,"class","font-bold mb-2"),y(C,"icon","mdi:file-outline"),j.disabled=L=t[8]||t[9],_(j,"class","border border-terminal-border text-terminal-text px-4 py-2 hover:bg-yellow-400 transition-colors flex-1 flex items-center justify-center gap-2"),S(j,"bg-yellow-400","file"===t[0]),S(j,"bg-terminal-bg","file"!==t[0]),S(j,"opacity-50",t[8]||t[9]),y(z,"icon","mdi:web"),E.disabled=A=t[8]||t[9],_(E,"class","border border-terminal-border text-terminal-text px-4 py-2 hover:bg-yellow-400 transition-colors flex-1 flex items-center justify-center gap-2"),S(E,"bg-yellow-400","url"===t[0]),S(E,"bg-terminal-bg","url"!==t[0]),S(E,"opacity-50",t[8]||t[9]),_(k,"class","flex gap-2 mb-3"),_(c,"class","mb-4"),_(P,"class","font-bold mb-2"),_(J,"class","text-terminal-text-dim block mb-1"),y(q,"icon","mdi:waveform"),_(H,"type","button"),H.disabled=K=t[8]||t[9],_(H,"class","border border-terminal-border text-terminal-text px-3 py-2 flex-1 hover:bg-yellow-400 transition-colors flex items-center justify-center gap-2"),S(H,"bg-yellow-400",!t[10]),S(H,"bg-terminal-bg",t[10]),S(H,"opacity-50",t[8]||t[9]),y(Y,"icon","mdi:package-variant"),_(Q,"type","button"),Q.disabled=ee=t[8]||t[9],_(Q,"class","border border-terminal-border text-terminal-text px-3 py-2 flex-1 hover:bg-yellow-400 transition-colors flex items-center justify-center gap-2"),S(Q,"bg-yellow-400",t[10]),S(Q,"bg-terminal-bg",!t[10]),S(Q,"opacity-50",t[8]||t[9]),_(G,"class","flex gap-2"),_(ne,"class","text-xs text-terminal-text-dim mt-1"),_(oe,"for","chunk-size"),_(oe,"class","text-terminal-text-dim block mb-1"),_(de,"for","llm-mode"),_(de,"class","text-terminal-text-dim block mb-1"),pe.__value="disabled",w(pe,pe.__value),fe.__value="per_chunk",w(fe,fe.__value),be.__value="post_process",w(be,be.__value),_(me,"id","llm-mode"),me.disabled=ge=t[8]||t[9],_(me,"class","bg-terminal-bg-light border border-terminal-border text-terminal-text px-3 py-2 w-full focus:outline-none focus:border-terminal-accent"),void 0===t[4]&&U(()=>t[31].call(me)),S(me,"opacity-50",t[8]||t[9]),_(N,"class","space-y-3"),_(I,"class","mb-4 flex-1"),_(xe,"class","px-4 py-2 transition-colors w-full font-bold flex items-center justify-center gap-2"),S(xe,"bg-status-info",!t[8]&&!t[9]),S(xe,"bg-status-error",t[8]||t[9]),S(xe,"text-terminal-bg",!t[8]&&!t[9]||t[8]||t[9]),S(xe,"hover:bg-blue-500",!t[8]&&!t[9]),S(xe,"hover:bg-red-600",t[8]||t[9]),_(n,"class","border border-terminal-border p-4 flex flex-col")},m(e,r){u(e,n,r),d(n,o),d(n,s),d(n,l),d(n,a),d(n,c),d(c,p),d(c,h),d(c,k),d(k,j),d(j,C),d(j,T),d(k,M),d(k,E),d(E,z),d(E,O),d(c,F),je.m(c,null),d(n,D),d(n,I),d(I,P),d(I,R),d(I,N),d(N,B),d(B,J),d(B,W),d(B,G),d(G,H),d(H,q),d(H,V),d(G,X),d(G,Q),d(Q,Y),d(Q,Z),d(B,te),d(B,ne),Te.m(ne,null),d(N,re),d(N,ie),d(ie,oe),d(oe,se),d(ie,le),Ee.m(ie,null),d(N,ae),d(N,ce),d(ce,de),d(ce,ue),d(ce,me),d(me,pe),d(me,fe),d(me,be),$(me,t[4],!0),d(n,he),d(n,xe),Ae.m(xe,null),d(xe,_e),Ie.m(xe,null),ye||(ve=[x(j,"click",t[21]),x(E,"click",t[22]),x(H,"click",t[27]),x(Q,"click",t[28]),x(me,"change",t[31]),x(xe,"click",function(){i(t[8]||t[9]?t[19]:t[18])&&(t[8]||t[9]?t[19]:t[18]).apply(this,arguments)})],ye=!0)},p(e,n){t=e,768&n[0]&&L!==(L=t[8]||t[9])&&(j.disabled=L),1&n[0]&&S(j,"bg-yellow-400","file"===t[0]),1&n[0]&&S(j,"bg-terminal-bg","file"!==t[0]),768&n[0]&&S(j,"opacity-50",t[8]||t[9]),768&n[0]&&A!==(A=t[8]||t[9])&&(E.disabled=A),1&n[0]&&S(E,"bg-yellow-400","url"===t[0]),1&n[0]&&S(E,"bg-terminal-bg","url"!==t[0]),768&n[0]&&S(E,"opacity-50",t[8]||t[9]),$e===($e=ke(t))&&je?je.p(t,n):(je.d(1),je=$e(t),je&&(je.c(),je.m(c,null))),768&n[0]&&K!==(K=t[8]||t[9])&&(H.disabled=K),1024&n[0]&&S(H,"bg-yellow-400",!t[10]),1024&n[0]&&S(H,"bg-terminal-bg",t[10]),768&n[0]&&S(H,"opacity-50",t[8]||t[9]),768&n[0]&&ee!==(ee=t[8]||t[9])&&(Q.disabled=ee),1024&n[0]&&S(Q,"bg-yellow-400",t[10]),1024&n[0]&&S(Q,"bg-terminal-bg",!t[10]),768&n[0]&&S(Q,"opacity-50",t[8]||t[9]),Ce!==(Ce=Se(t))&&(Te.d(1),Te=Ce(t),Te&&(Te.c(),Te.m(ne,null))),1024&n[0]&&we!==(we=t[10]?"Upload chunk size:":"Chunk size:")&&v(se,we),Me===(Me=Le(t))&&Ee?Ee.p(t,n):(Ee.d(1),Ee=Me(t),Ee&&(Ee.c(),Ee.m(ie,null))),768&n[0]&&ge!==(ge=t[8]||t[9])&&(me.disabled=ge),16&n[0]&&$(me,t[4]),768&n[0]&&S(me,"opacity-50",t[8]||t[9]),Oe!==(Oe=ze(t))&&(Ae.d(1),Ae=Oe(t),Ae&&(Ae.c(),Ae.m(xe,_e))),De===(De=Fe(t))&&Ie?Ie.p(t,n):(Ie.d(1),Ie=De(t),Ie&&(Ie.c(),Ie.m(xe,null))),768&n[0]&&S(xe,"bg-status-info",!t[8]&&!t[9]),768&n[0]&&S(xe,"bg-status-error",t[8]||t[9]),768&n[0]&&S(xe,"text-terminal-bg",!t[8]&&!t[9]||t[8]||t[9]),768&n[0]&&S(xe,"hover:bg-blue-500",!t[8]&&!t[9]),768&n[0]&&S(xe,"hover:bg-red-600",t[8]||t[9])},i:e,o:e,d(e){e&&m(n),je.d(),Te.d(),Ee.d(),Ae.d(),Ie.d(),ye=!1,r(ve)}}}function st(e,t,n){let r,i,o,s,d,u,m,p,f,b,g,h,x,_,y,v,w,k,$,S,C,T;a(e,me,e=>n(8,r=e)),a(e,we,e=>n(9,i=e)),a(e,fe,e=>n(36,o=e)),a(e,he,e=>n(37,s=e)),a(e,ge,e=>n(38,d=e)),a(e,xe,e=>n(39,u=e)),a(e,_e,e=>n(40,m=e)),a(e,ye,e=>n(41,p=e)),a(e,ve,e=>n(42,f=e)),a(e,pe,e=>n(43,b=e)),a(e,Te,e=>n(44,g=e)),a(e,Se,e=>n(45,h=e)),a(e,ke,e=>n(46,x=e)),a(e,Ce,e=>n(47,_=e)),a(e,Ae,e=>n(48,y=e)),a(e,Oe,e=>n(49,v=e)),a(e,ze,e=>n(50,w=e)),a(e,Ee,e=>n(51,k=e)),a(e,Me,e=>n(52,$=e)),a(e,Le,e=>n(53,S=e)),a(e,be,e=>n(54,C=e)),a(e,$e,e=>n(10,T=e));let L,M,E="file",z=null,A="",F=.25,D=5,I="disabled",U={icon:"mdi:file-plus",title:"Drop files here or click to browse",subtitle:"MP3, WAV, M4A, FLAC, etc. (up to 1GB)"},P=null,R=null,N=null;function B(e){const t=T?"chunked":"streaming",r=T?'Click "Chunked Stream" to upload in chunks with real-time processing':'Click "Live Transcribe" to start';n(7,U={icon:"mdi:file-music",title:e.name,subtitle:\`Ready to \${t} transcribe (\${De(e.size)})\`,description:r}),n(20,z=e)}function J(){n(7,U={icon:"mdi:file-plus",title:"Drop files here or click to browse",subtitle:"MP3, WAV, M4A, FLAC, etc. (up to 1GB)"}),n(20,z=null),M&&n(6,M.value="",M)}function W(){L&&(L.classList.remove("border-terminal-accent","bg-green-900/20"),L.classList.add("border-terminal-border"))}function G(){M&&M.click()}function H(e){n(0,E=e),"file"===e&&J()}function q(){c(be,C=Date.now(),C),R=setInterval(()=>{},1e3)}function V(){R&&(clearInterval(R),R=null)}function K(e){try{!async function(e){switch(e.type){case"initialized":c(Me,$=e.total_chunks,$),ce.info("Chunked upload initialized",{parent_job_id:e.parent_job_id,total_chunks:e.total_chunks});break;case"progress_update":c(Ce,_={upload:e.upload_progress||0,processing:e.processing_progress||0,overall:e.progress||0},_),c(Ee,k=e.uploaded_chunks||0,k),c(ze,w=e.completed_chunks||0,w),c(Oe,v=e.failed_chunks||0,v),c(Ae,y=e.success_rate||0,y);break;case"chunk_complete":Ue(e.chunk_index,{status:"complete",text:e.text,rawText:e.raw_text||e.text,correctedText:e.corrected_text,processingTime:e.processing_time,llmApplied:e.llm_applied||!1}),function(){const e=l(je);let t="";for(let n=0;n<e.length;n++){const r=e[n];if(!r||"complete"!==r.status||!r.text)break;t+=(t?" ":"")+("speed"===h&&r.correctedText?r.correctedText:r.text)}c(Te,g=t,g)}();break;case"chunk_failed":Ue(e.chunk_index,{status:"failed",error:e.error});break;case"partial_transcript":c(Te,g=e.partial_transcript,g);break;case"final_result":c(Ce,_={upload:100,processing:100,overall:100},_);const t=l(de),r=t.findIndex(t=>t.job_id===e.parent_job_id);-1!==r&&(t[r]={...t[r],status:"done",final_transcript:e.final_transcript,raw_transcript:e.raw_transcript,corrected_transcript:e.corrected_transcript,completed_at:(new Date).toISOString(),progress:100,success_rate:e.success_rate,transcripts:[{text:e.final_transcript,raw_text:e.raw_transcript,segments:[],start:0,duration:t[r].file_size||0,chunk_index:"chunked_streaming"}]},de.set(t)),ce.complete("Chunked streaming completed",{parent_job_id:e.parent_job_id,success_rate:e.success_rate,transcript_length:e.final_transcript?.length||0});try{[500,1500,3e3].forEach((e,t)=>{setTimeout(async()=>{try{await Pe(),ce.info(\`Jobs refresh attempt \${t+1} completed after chunked streaming\`)}catch(e){ce.error(\`Jobs refresh attempt \${t+1} failed after chunked streaming\`,e)}},e)})}catch(e){ce.error("Failed to refresh jobs after chunked streaming",e)}c(ke,x=!0,x),c(we,i=!1,i),N&&(ce.info("Closing chunked stream after completion",{readyState:N.readyState}),N.onmessage=null,N.onerror=null,N.onopen=null,N.close(),N=null),V(),setTimeout(()=>{"file"===E?J():n(1,A="")},2e3);break;case"job_terminated":ce.error("Chunked job terminated",{reason:e.reason,status:e.status}),Q()}}(JSON.parse(e.data))}catch(t){console.error("Failed to parse chunked SSE data:",t,e.data)}}function X(e){if(console.log("Chunked SSE error event:",e),N&&N.readyState===EventSource.CLOSED)return ce.info("Chunked stream closed after completion",{readyState:N.readyState}),void(i&&ce.warn("Chunked stream closed unexpectedly while still processing"));ce.error("Chunked stream error",e),console.error("Chunked SSE error:",e),i&&alert("Stream connection lost. Check console for details.")}function Q(){N&&(ce.info("Closing chunked stream",{readyState:N.readyState}),N.onmessage=null,N.onerror=null,N.onopen=null,N.close(),N=null),c(we,i=!1,i),V(),setTimeout(()=>{"file"===E?J():n(1,A="")},2e3)}async function Y(e){const t=l(de),n=t.find(e=>"streaming"===e.processing_method&&e.filename===o&&"processing"===e.status);switch(e.type){case"status":c(he,s+=\`📡 \${e.message}\\n\`,s),n&&e.job_id&&n.job_id.startsWith("stream_")&&(n.job_id=e.job_id,n.file_size=e.total_size,n.estimated_chunks=e.estimated_chunks,de.set(t)),e.total_size&&c(ye,p=De(e.total_size),p);break;case"chunk_info":c(_e,m=e.total_chunks,m),c(he,s+=\`🧩 Ready to process \${e.total_chunks} chunks (\${e.chunk_size_mb}MB each)\\n\\n\`,s);break;case"chunk_start":c(ge,d=e.progress,d),c(he,s+=\`🔄 Chunk \${e.chunk_index+1} (\${e.progress}%) - transcribing...\\n\`,s),n&&(n.progress=e.progress,de.set(t));break;case"delta":if(e.llm_applied)c(he,s+=\`📝 Raw: "\${e.raw_text}"\\n\`,s),c(he,s+=\`🧠 LLM: "\${e.corrected_text}"\\n\\n\`,s);else if(e.llm_error)c(he,s+=\`📝 "\${e.raw_text}"\\n\`,s),c(he,s+=\`⚠️  LLM failed: \${e.llm_error}\\n\\n\`,s);else{const t=e.text||e.raw_text;c(he,s+=\`📝 "\${t}"\\n\\n\`,s)}c(xe,u+=1,u);break;case"chunk_done":c(ge,d=e.progress,d),c(he,s+=\`✅ Chunk \${e.chunk_index+1} completed (\${e.progress}%)\\n\\n\`,s);break;case"chunk_error":c(he,s+=\`❌ Chunk \${e.chunk_index+1} error: \${e.error}\\n\\n\`,s);break;case"llm_processing":const r="post_process"===e.mode?"post-processing":"per-chunk";c(he,s+=\`🧠 \${e.message||\`Applying LLM corrections (\${r})...\`}\\n\`,s);break;case"llm_done":const i="post_process"===e.mode?"Post-processing":"Per-chunk";c(he,s+=\`✅ \${i} LLM correction completed\\n\`,s),"post_process"===e.mode&&c(he,s+=\`📝 Improved transcript:\\n"\${e.corrected_text}"\\n\\n\`,s);break;case"llm_error":const l="post_process"===e.mode?"Post-processing":"Per-chunk";c(he,s+=\`❌ \${l} LLM correction failed: \${e.error}\\n\`,s),e.fallback_text&&c(he,s+=\`📝 Using original transcript: "\${e.fallback_text}"\\n\\n\`,s);break;case"done":c(he,s+="\\n🎉 Transcription complete!\\n",s),c(he,s+=\`📊 Final transcript: "\${e.final_transcript}"\\n\`,s);const a=t.find(e=>"streaming"===e.processing_method&&e.filename===o&&"processing"===e.status);if(a){a.status="done",a.final_transcript=e.final_transcript,a.raw_transcript=e.raw_transcript,a.corrected_transcript=e.corrected_transcript,a.total_segments=e.total_segments,a.completed_at=(new Date).toISOString(),a.progress=100,a.transcripts=[{text:e.final_transcript,raw_text:e.raw_transcript,segments:[],start:0,duration:a.file_size||0,chunk_index:"streaming"}],de.set(t);try{await async function(e){try{if(!(await fetch("/save-streaming-job",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({job_id:e.job_id,filename:e.filename,file_size:e.file_size,final_transcript:e.final_transcript,raw_transcript:e.raw_transcript,corrected_transcript:e.corrected_transcript,total_segments:e.total_segments,created_at:e.created_at,completed_at:e.completed_at,use_llm:e.use_llm,llm_mode:e.llm_mode,chunk_size_mb:e.chunk_size_mb,source_url:e.source_url||null,transcripts:e.transcripts||[]})})).ok)throw new Error("Failed to save streaming job");ae.info("api","Saved streaming job to server",{job_id:e.job_id})}catch(e){ae.error("Failed to save streaming job to server",e)}}(a),ce.info("Saved streaming job to server",{job_id:a.job_id});[500,1500,3e3].forEach((e,t)=>{setTimeout(async()=>{try{await Pe(),ce.info(\`Jobs refresh attempt \${t+1} completed after streaming\`)}catch(e){ce.error(\`Jobs refresh attempt \${t+1} failed after streaming\`,e)}},e)})}catch(e){ce.error("Failed to save streaming job to server",e),setTimeout(async()=>{try{await Pe(),ce.info("Attempted jobs refresh after save failure")}catch(e){ce.error("Failed to refresh jobs after save failure",e)}},1e3)}ce.complete("Streaming job completed",{job_id:a.job_id,filename:o,transcript_length:e.final_transcript?.length||0})}break;case"error":c(he,s+=\`\\n❌ Error: \${e.error}\\n\`,s);const f=t.find(e=>"streaming"===e.processing_method&&e.filename===o&&"processing"===e.status);f&&(f.status="failed",f.error=e.error,f.failed_at=(new Date).toISOString(),de.set(t))}}function Z(){P&&(P.abort(),P=null),c(me,r=!1,r),V(),setTimeout(()=>{"file"===E?J():n(1,A="")},2e3)}return e.$$.update=()=>{1048576&e.$$.dirty[0]&&z&&B(z)},[E,A,F,D,I,L,M,U,r,i,T,function(e){e.preventDefault(),L&&(L.classList.add("border-terminal-accent","bg-green-900/20"),L.classList.remove("border-terminal-border"))},W,function(e){e.preventDefault(),W();const t=Array.from(e.dataTransfer.files);t.length>0&&B(t[0])},function(e){const t=Array.from(e.target.files);t.length>0&&B(t[0])},G,H,function(){if(r||i){return\`🔄 \${i?"Chunked Streaming":"Streaming"} \${i?S:o}...\`}return"file"===E?T?z?\`Chunked Stream \${z.name}\`:"Select File for Chunked Streaming":z?\`Live Transcribe \${z.name}\`:"Select File to Transcribe":T?"Chunked Stream URL":"Live Transcribe URL"},function(){T?(we.set(!1),ke.set(!1),je.set([]),Te.set(""),Le.set(""),Me.set(0),Ee.set(0),ze.set(0),Oe.set(0),Ae.set(0),Ce.set({upload:0,processing:0,overall:0}),Ie=0):c(pe,b=!1,b),setTimeout(()=>{T?async function(){if(i)return;let e={chunkSizeMB:D,useLLM:"disabled"!==I};"disabled"!==I&&(e.llmMode=I);if("file"===E){if(!z)return void G();e.filename=z.name,e.file=z}else if("url"===E){if(!A.trim())return void alert("Please enter an audio URL first");e.url=A.trim(),e.filename=A.split("/").pop()||"audio file"}try{const t=await async function(e){const{filename:t,file:n,url:r,chunkSizeMB:i=5,useLLM:o=!1,llmMode:s="per_chunk",webhookUrl:a=null}=e;let c;if(n)c=n.size;else{if(!r)throw new Error("Either file or url must be provided");c=0}const d={filename:t||(n?n.name:r.split("/").pop()),total_size:c,chunk_size_mb:i,use_llm:o,llm_mode:s,webhook_url:a},u=await fetch("/chunked-upload-stream",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(!u.ok){const e=await u.json();throw new Error(e.error||"Failed to initialize chunked upload")}const m=await u.json(),p=l(de),f={job_id:m.parent_job_id,filename:d.filename,status:"uploading",file_size:c,processing_method:"chunked_upload_streaming",upload_method:"chunked_streaming",use_llm:o,llm_mode:s,chunk_size_mb:i,total_chunks:m.chunk_info.total_chunks,uploaded_chunks:0,completed_chunks:0,failed_chunks:0,created_at:(new Date).toISOString(),type:"chunked_upload_streaming"};return de.set([f,...p]),{...m,job:f}}(e);if(c(we,i=!0,i),c(ke,x=!0,x),c(Le,S=t.parent_job_id,S),c(Me,$=t.chunk_info.total_chunks,$),function(e){const t=Array(e).fill(null).map((e,t)=>({chunkIndex:t,status:"pending",text:"",rawText:"",correctedText:"",processingTime:null,completedAt:null,arrivalOrder:null,uploadProgress:0,error:null,llmApplied:!1,segments:[]}));je.set(t)}(t.chunk_info.total_chunks),q(),N=await async function(e){return new EventSource(\`/chunked-stream/\${e}\`)}(t.parent_job_id),N.onmessage=K,N.onerror=X,e.file)try{const n=await async function(e,t,n,r=3){if(console.log("uploadChunksInParallel called:",{fileSize:e.size,uploadUrlsLength:t?.length,parentJobId:n,maxConcurrent:r}),!t||0===t.length)throw new Error("No upload URLs provided");const i=t.map(async(t,r)=>{console.log(\`Starting upload for chunk \${r}:\`,{chunkIndex:t.chunk_index,byteRange:t.byte_range,uploadUrl:t.upload_url,parentJobId:t.parent_job_id});const i=t.byte_range[0],o=t.byte_range[1]+1,s=e.slice(i,o);console.log(\`Chunk \${r} data:\`,{chunkIndex:t.chunk_index,chunkSize:s.size,expectedStart:i,expectedEnd:o});try{console.log(\`Uploading chunk \${t.chunk_index} to Worker...\`);const e=new FormData;e.append("chunk",s,\`chunk.\${t.chunk_index}\`),e.append("parent_job_id",n),e.append("chunk_index",t.chunk_index.toString()),e.append("expected_size",t.expected_size.toString());const r=await fetch(Fe+t.upload_url,{method:"POST",body:e});if(console.log(\`Chunk \${t.chunk_index} upload response:\`,{status:r.status,statusText:r.statusText,ok:r.ok}),!r.ok){const e=await r.json().catch(()=>({error:"Unknown error"}));throw new Error(\`Upload failed: \${r.status} \${r.statusText} - \${e.error||"Unknown error"}\`)}const i=await r.json();return console.log(\`Chunk \${t.chunk_index} completed successfully:\`,i),{chunkIndex:t.chunk_index,success:!0,size:s.size,response:i}}catch(e){return console.error(\`Chunk \${t.chunk_index} failed:\`,e),{chunkIndex:t.chunk_index,success:!1,error:e.message}}});console.log(\`Starting \${i.length} concurrent uploads...\`);const o=await Promise.allSettled(i);console.log("All upload promises settled:",o);const s=o.map(e=>"fulfilled"===e.status?e.value:{success:!1,error:e.reason?.message||"Upload failed"});return console.log("Final upload results:",s),s}(e.file,t.upload_urls,t.parent_job_id,3),r=n.filter(e=>!e.success);r.length>0&&(console.error("Some chunks failed to upload:",r),ce.error("Some chunks failed to upload",{failures:r}))}catch(e){return console.error("Upload chunks failed:",e),ce.error("Upload chunks failed",e),alert(\`Upload failed: \${e.message}\`),void Q()}else console.log("No file provided, expecting URL upload handling")}catch(e){ce.error("Chunked streaming failed",e),console.error("Chunked streaming error:",e),alert(\`Chunked streaming failed: \${e.message}\`),Q()}}():async function(){if(r)return;let e,t;if("file"===E){if(!z)return void G();t=z.name;const n=new FormData;n.append("file",z),n.append("chunk_size_mb",F.toString()),"disabled"!==I?(n.append("use_llm","true"),n.append("llm_mode",I)):n.append("use_llm","false"),e={method:"POST",body:n}}else if("url"===E){if(!A.trim())return void alert("Please enter an audio URL first");t=A.split("/").pop()||"audio file";const n={url:A.trim(),chunk_size_mb:F};"disabled"!==I?(n.use_llm=!0,n.llm_mode=I):n.use_llm=!1,e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}}await async function(e,t,n){if(r)return;c(me,r=!0,r),c(pe,b=!0,b),c(fe,o=n,o),c(he,s="",s),c(ge,d=0,d),c(xe,u=0,u),c(_e,m=0,m),c(ye,p="",p),c(ve,f=I,f),q();const i={job_id:"stream_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),filename:n,status:"processing",file_size:0,processing_method:"streaming",upload_method:"streaming",created_at:(new Date).toISOString(),use_llm:"disabled"!==I,llm_mode:I,chunk_size_mb:F,progress:0},a=l(de);de.set([i,...a]),P=new AbortController,t.signal=P.signal,c(he,s="🚀 Starting transcription...\\n\\n",s);try{const n=await fetch(e,t);if(!n.ok)throw new Error("Streaming failed: "+n.status);const i=n.body.getReader(),o=new TextDecoder;let s="";for(;;){const{done:e,value:t}=await i.read();if(e){ce.complete("Stream reader reached end");break}if(!r){ce.info("warning","Stream stopped by user");break}s+=o.decode(t,{stream:!0});const n=s.split("\\n");s=n.pop()||"";for(const e of n)if(e.startsWith("data: "))try{const t=JSON.parse(e.slice(6));await Y(t)}catch(t){console.error("Failed to parse SSE data:",t,e)}}}catch(e){"AbortError"===e.name?(ce.info("stream","Stream aborted by user"),c(he,s+="\\n❌ Streaming stopped by user\\n",s)):(ce.error("Streaming failed",e),c(he,s+=\`\\n❌ Streaming failed: \${e.message}\\n\`,s))}finally{Z()}}("/stream",e,t)}()},100)},function(){i?Q():r&&Z()},z,()=>H("file"),()=>H("url"),function(e){O[e?"unshift":"push"](()=>{L=e,n(5,L)})},e=>"Enter"===e.key&&G(),function(e){O[e?"unshift":"push"](()=>{M=e,n(6,M)})},function(){A=this.value,n(1,A)},()=>c($e,T=!1,T),()=>c($e,T=!0,T),function(){D=j(this),n(3,D)},function(){F=j(this),n(2,F)},function(){I=j(this),n(4,I)}]}class lt extends ne{constructor(e){super(),te(this,e,st,ot,o,{},null,[-1,-1,-1])}}function at(e,t,n){const r=e.slice();return r[27]=t[n],r}function ct(e,t,n){const r=e.slice();return r[30]=t[n],r[32]=n,r}function dt(e){let t,n,r,i,o,s,l,a,c,p,h,x,w=(e[6]||e[4]?e[10]:e[11])+"";function k(e,t){return e[6]?pt:e[7]?mt:ut}let $=k(e),j=$(e);function S(e,t){return e[7]||e[6]?bt:ft}let C=S(e),T=C(e);function L(e,t){return e[6]||e[4]?ht:gt}let M=L(e),E=M(e);function z(e,t){return e[6]||e[4]?_t:xt}let O=z(e),A=O(e);return{c(){t=f("div"),n=f("div"),r=f("iconify-icon"),i=g(),j.c(),o=g(),s=f("div"),l=f("div"),T.c(),a=g(),c=f("span"),p=b(w),h=g(),E.c(),x=g(),A.c(),y(r,"icon","mdi:waveform"),y(r,"class","text-lg"),_(n,"class","font-bold text-center mb-4 border-b border-terminal-border pb-2 flex items-center justify-center gap-2"),_(c,"class","text-terminal-text-dim"),_(l,"class","flex items-center gap-2 mb-2"),_(s,"class","mb-4"),_(t,"class","border-2 border-terminal-border bg-terminal-bg-light p-4 mb-4")},m(e,m){u(e,t,m),d(t,n),d(n,r),d(n,i),j.m(n,null),d(t,o),d(t,s),d(s,l),T.m(l,null),d(l,a),d(l,c),d(c,p),d(s,h),E.m(s,null),d(t,x),A.m(t,null)},p(e,r){$!==($=k(e))&&(j.d(1),j=$(e),j&&(j.c(),j.m(n,null))),C===(C=S(e))&&T?T.p(e,r):(T.d(1),T=C(e),T&&(T.c(),T.m(l,a))),3152&r[0]&&w!==(w=(e[6]||e[4]?e[10]:e[11])+"")&&v(p,w),M===(M=L(e))&&E?E.p(e,r):(E.d(1),E=M(e),E&&(E.c(),E.m(s,null))),O===(O=z(e))&&A?A.p(e,r):(A.d(1),A=O(e),A&&(A.c(),A.m(t,null)))},d(e){e&&m(t),j.d(),T.d(),E.d(),A.d()}}}function ut(e){let t;return{c(){t=b("Streaming Results")},m(e,n){u(e,t,n)},d(e){e&&m(t)}}}function mt(e){let t;return{c(){t=b("Live Streaming Transcription")},m(e,n){u(e,t,n)},d(e){e&&m(t)}}}function pt(e){let t;return{c(){t=b("Chunked Upload Streaming")},m(e,n){u(e,t,n)},d(e){e&&m(t)}}}function ft(e){let t,n,r,i,o=e[4]?"Chunked streaming completed":"Streaming completed";return{c(){t=f("span"),n=g(),r=f("span"),i=b(o),_(t,"class","w-2 h-2 bg-status-success rounded-full"),_(r,"class","font-bold text-status-success")},m(e,o){u(e,t,o),u(e,n,o),u(e,r,o),d(r,i)},p(e,t){16&t[0]&&o!==(o=e[4]?"Chunked streaming completed":"Streaming completed")&&v(i,o)},d(e){e&&(m(t),m(n),m(r))}}}function bt(e){let t,n,r,i,o=e[6]?"Chunked streaming in progress...":"Streaming in progress...";return{c(){t=f("span"),n=g(),r=f("span"),i=b(o),_(t,"class","w-2 h-2 bg-status-info rounded-full animate-pulse"),_(r,"class","font-bold text-status-info")},m(e,o){u(e,t,o),u(e,n,o),u(e,r,o),d(r,i)},p(e,t){64&t[0]&&o!==(o=e[6]?"Chunked streaming in progress...":"Streaming in progress...")&&v(i,o)},d(e){e&&(m(t),m(n),m(r))}}}function gt(e){let t,n,r,i,o,s,l,a,c,p,h,x,y,w,$,j,S,C,T,L,M,E,z,O=(e[20]||"?")+"",A=(e[21]||"-")+"",F=Nt(e[8])+"";return{c(){t=f("div"),n=f("div"),r=b(e[18]),i=b("%"),o=g(),s=f("div"),l=f("span"),a=b("Chunks: "),c=b(e[19]),p=b("/"),h=b(O),x=g(),y=f("span"),w=b("Size: "),$=b(A),j=g(),S=f("span"),C=b("Elapsed: "),T=b(F),L=g(),M=f("span"),E=b("Mode: "),z=b(e[22]),_(n,"class","bg-status-info h-full flex items-center justify-center text-terminal-bg text-xs font-bold transition-all duration-300"),k(n,"width",e[18]+"%"),_(t,"class","bg-terminal-bg border border-terminal-border h-5 overflow-hidden"),_(s,"class","text-xs text-terminal-text-dim mt-2 grid grid-cols-2 md:grid-cols-4 gap-2")},m(e,m){u(e,t,m),d(t,n),d(n,r),d(n,i),u(e,o,m),u(e,s,m),d(s,l),d(l,a),d(l,c),d(l,p),d(l,h),d(s,x),d(s,y),d(y,w),d(y,$),d(s,j),d(s,S),d(S,C),d(S,T),d(s,L),d(s,M),d(M,E),d(M,z)},p(e,t){262144&t[0]&&v(r,e[18]),262144&t[0]&&k(n,"width",e[18]+"%"),524288&t[0]&&v(c,e[19]),1048576&t[0]&&O!==(O=(e[20]||"?")+"")&&v(h,O),2097152&t[0]&&A!==(A=(e[21]||"-")+"")&&v($,A),256&t[0]&&F!==(F=Nt(e[8])+"")&&v(T,F),4194304&t[0]&&v(z,e[22])},d(e){e&&(m(t),m(o),m(s))}}}function ht(e){let t,n,r,i,o,s,l,a,c,p,h,x,y,w,$,j,S,C,T,L,M,E,z,O,A,F,D,I,U,P,R,N,B,J,W,G,H,q,V,K,X,Q,Y,Z,ee=e[12].upload+"",te=e[12].processing+"",ne=e[12].overall+"",re=Nt(e[8])+"";return{c(){t=f("div"),n=f("div"),r=f("div"),i=b("Upload "),o=b(ee),s=b("%"),l=g(),a=f("div"),c=f("div"),p=b("Processing "),h=b(te),x=b("%"),y=g(),w=f("div"),$=f("div"),j=b("Overall "),S=b(ne),C=b("%"),T=g(),L=f("div"),M=f("span"),E=b("Uploaded: "),z=b(e[13]),O=b("/"),A=b(e[14]),F=g(),D=f("span"),I=b("Completed: "),U=b(e[15]),P=b("/"),R=b(e[14]),N=g(),B=f("span"),J=b("Failed: "),W=b(e[16]),G=g(),H=f("span"),q=b("Success: "),V=b(e[17]),K=b("%"),X=g(),Q=f("span"),Y=b("Elapsed: "),Z=b(re),_(r,"class","bg-blue-500 h-full flex items-center justify-center text-terminal-bg text-xs font-bold transition-all duration-300"),k(r,"width",e[12].upload+"%"),_(n,"class","bg-terminal-bg border border-terminal-border h-4 overflow-hidden"),_(c,"class","bg-yellow-500 h-full flex items-center justify-center text-terminal-bg text-xs font-bold transition-all duration-300"),k(c,"width",e[12].processing+"%"),_(a,"class","bg-terminal-bg border border-terminal-border h-4 overflow-hidden"),_($,"class","bg-green-500 h-full flex items-center justify-center text-terminal-bg text-xs font-bold transition-all duration-300"),k($,"width",e[12].overall+"%"),_(w,"class","bg-terminal-bg border border-terminal-border h-5 overflow-hidden"),_(t,"class","space-y-2"),_(L,"class","text-xs text-terminal-text-dim mt-2 grid grid-cols-2 md:grid-cols-5 gap-2")},m(e,m){u(e,t,m),d(t,n),d(n,r),d(r,i),d(r,o),d(r,s),d(t,l),d(t,a),d(a,c),d(c,p),d(c,h),d(c,x),d(t,y),d(t,w),d(w,$),d($,j),d($,S),d($,C),u(e,T,m),u(e,L,m),d(L,M),d(M,E),d(M,z),d(M,O),d(M,A),d(L,F),d(L,D),d(D,I),d(D,U),d(D,P),d(D,R),d(L,N),d(L,B),d(B,J),d(B,W),d(L,G),d(L,H),d(H,q),d(H,V),d(H,K),d(L,X),d(L,Q),d(Q,Y),d(Q,Z)},p(e,t){4096&t[0]&&ee!==(ee=e[12].upload+"")&&v(o,ee),4096&t[0]&&k(r,"width",e[12].upload+"%"),4096&t[0]&&te!==(te=e[12].processing+"")&&v(h,te),4096&t[0]&&k(c,"width",e[12].processing+"%"),4096&t[0]&&ne!==(ne=e[12].overall+"")&&v(S,ne),4096&t[0]&&k($,"width",e[12].overall+"%"),8192&t[0]&&v(z,e[13]),16384&t[0]&&v(A,e[14]),32768&t[0]&&v(U,e[15]),16384&t[0]&&v(R,e[14]),65536&t[0]&&v(W,e[16]),131072&t[0]&&v(V,e[17]),256&t[0]&&re!==(re=Nt(e[8])+"")&&v(Z,re)},d(e){e&&(m(t),m(T),m(L))}}}function xt(e){let t,n,r,i,o,s;function l(e,t){return e[7]?vt:yt}let a=l(e),c=a(e);function p(e,t){return e[3]?kt:wt}let b=p(e),h=b(e);return{c(){t=f("div"),n=f("div"),r=f("iconify-icon"),i=g(),c.c(),o=g(),s=f("div"),h.c(),y(r,"icon","mdi:text-box"),y(r,"class","text-lg"),_(n,"class","p-3 border-b border-terminal-border font-bold text-terminal-accent flex items-center gap-2"),_(s,"id","streaming-transcript"),_(s,"class","p-4 max-h-80 overflow-y-auto font-mono text-sm leading-relaxed"),_(t,"class","border border-terminal-border bg-terminal-bg")},m(e,l){u(e,t,l),d(t,n),d(n,r),d(n,i),c.m(n,null),d(t,o),d(t,s),h.m(s,null)},p(e,t){a!==(a=l(e))&&(c.d(1),c=a(e),c&&(c.c(),c.m(n,null))),b===(b=p(e))&&h?h.p(e,t):(h.d(1),h=b(e),h&&(h.c(),h.m(s,null)))},d(e){e&&m(t),c.d(),h.d()}}}function _t(e){let t,n,i,o,s,l,a,c,h,w,k,$,j,C,T,L,M,E,z,O,A,F,D,I,U,P,R,N,B,J,W,G,H,q;function V(e,t){return"speed"===e[1]?jt:$t}let X=V(e),Q=X(e),Y=K(e[0]),Z=[];for(let t=0;t<Y.length;t+=1)Z[t]=Ct(ct(e,Y,t));let ee="speed"===e[1]&&e[9].length>0&&Tt(e);function te(e,t){return"speed"===e[1]?Ft:At}let ne=te(e),re=ne(e);function ie(e,t){return e[2]?It:Dt}let oe=ie(e),se=oe(e);return{c(){t=f("div"),n=f("span"),n.textContent="View Mode:",i=g(),o=f("div"),s=f("button"),s.innerHTML='<iconify-icon icon="mdi:flash"></iconify-icon> First to Complete',l=g(),a=f("button"),a.innerHTML='<iconify-icon icon="mdi:sort-numeric-ascending"></iconify-icon> In Order Only',c=g(),h=f("span"),Q.c(),w=g(),k=f("div"),$=f("div"),j=f("div"),C=f("iconify-icon"),T=b(" \\n            Chunk Status Grid\\n            "),L=f("span"),M=b("("),E=b(e[15]),z=b("/"),O=b(e[14]),A=b(" completed)"),F=g(),D=f("div"),I=f("div");for(let e=0;e<Z.length;e+=1)Z[e].c();U=g(),ee&&ee.c(),P=g(),R=f("div"),N=f("div"),B=f("iconify-icon"),J=g(),re.c(),W=g(),G=f("div"),se.c(),_(n,"class","font-bold text-terminal-accent"),_(s,"type","button"),_(s,"class","border border-terminal-border text-terminal-text px-3 py-1 text-sm hover:bg-yellow-400 transition-colors flex items-center gap-2"),S(s,"bg-yellow-400","speed"===e[1]),S(s,"bg-terminal-bg","speed"!==e[1]),_(a,"type","button"),_(a,"class","border border-terminal-border text-terminal-text px-3 py-1 text-sm hover:bg-yellow-400 transition-colors flex items-center gap-2"),S(a,"bg-yellow-400","order"===e[1]),S(a,"bg-terminal-bg","order"!==e[1]),_(o,"class","flex gap-2"),_(h,"class","text-xs text-terminal-text-dim"),_(t,"class","mb-4 flex items-center gap-4"),y(C,"icon","mdi:view-grid"),y(C,"class","text-lg"),_(L,"class","text-xs text-terminal-text-dim ml-auto"),_(j,"class","p-3 border-b border-terminal-border font-bold text-terminal-accent flex items-center gap-2"),_(I,"class","grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 gap-2"),_(D,"class","p-4 max-h-80 overflow-y-auto"),_($,"class","border border-terminal-border bg-terminal-bg"),y(B,"icon","mdi:text-box"),y(B,"class","text-lg"),_(N,"class","p-3 border-b border-terminal-border font-bold text-terminal-accent flex items-center gap-2"),_(G,"id","chunked-readable-transcript"),_(G,"class","p-4 max-h-80 overflow-y-auto font-mono text-sm leading-relaxed"),_(R,"class","border border-terminal-border bg-terminal-bg"),_(k,"class","space-y-4")},m(r,m){u(r,t,m),d(t,n),d(t,i),d(t,o),d(o,s),d(o,l),d(o,a),d(t,c),d(t,h),Q.m(h,null),u(r,w,m),u(r,k,m),d(k,$),d($,j),d(j,C),d(j,T),d(j,L),d(L,M),d(L,E),d(L,z),d(L,O),d(L,A),d($,F),d($,D),d(D,I);for(let e=0;e<Z.length;e+=1)Z[e]&&Z[e].m(I,null);d(k,U),ee&&ee.m(k,null),d(k,P),d(k,R),d(R,N),d(N,B),d(N,J),re.m(N,null),d(R,W),d(R,G),se.m(G,null),H||(q=[x(s,"click",e[25]),x(a,"click",e[26])],H=!0)},p(e,t){if(2&t[0]&&S(s,"bg-yellow-400","speed"===e[1]),2&t[0]&&S(s,"bg-terminal-bg","speed"!==e[1]),2&t[0]&&S(a,"bg-yellow-400","order"===e[1]),2&t[0]&&S(a,"bg-terminal-bg","order"!==e[1]),X!==(X=V(e))&&(Q.d(1),Q=X(e),Q&&(Q.c(),Q.m(h,null))),32768&t[0]&&v(E,e[15]),16384&t[0]&&v(O,e[14]),1&t[0]){let n;for(Y=K(e[0]),n=0;n<Y.length;n+=1){const r=ct(e,Y,n);Z[n]?Z[n].p(r,t):(Z[n]=Ct(r),Z[n].c(),Z[n].m(I,null))}for(;n<Z.length;n+=1)Z[n].d(1);Z.length=Y.length}"speed"===e[1]&&e[9].length>0?ee?ee.p(e,t):(ee=Tt(e),ee.c(),ee.m(k,P)):ee&&(ee.d(1),ee=null),ne!==(ne=te(e))&&(re.d(1),re=ne(e),re&&(re.c(),re.m(N,null))),oe===(oe=ie(e))&&se?se.p(e,t):(se.d(1),se=oe(e),se&&(se.c(),se.m(G,null)))},d(e){e&&(m(t),m(w),m(k)),Q.d(),p(Z,e),ee&&ee.d(),re.d(),se.d(),H=!1,r(q)}}}function yt(e){let t;return{c(){t=b("Final Transcript:")},m(e,n){u(e,t,n)},d(e){e&&m(t)}}}function vt(e){let t;return{c(){t=b("Live Transcript:")},m(e,n){u(e,t,n)},d(e){e&&m(t)}}}function wt(t){let n;return{c(){n=f("div"),n.textContent="Waiting for transcription results...",_(n,"class","text-terminal-text-dim italic")},m(e,t){u(e,n,t)},p:e,d(e){e&&m(n)}}}function kt(e){let t,n;return{c(){t=f("pre"),n=b(e[3]),_(t,"class","whitespace-pre-wrap")},m(e,r){u(e,t,r),d(t,n)},p(e,t){8&t[0]&&v(n,e[3])},d(e){e&&m(t)}}}function $t(e){let t;return{c(){t=b("Shows only contiguous chunks in order (readable flow)")},m(e,n){u(e,t,n)},d(e){e&&m(t)}}}function jt(e){let t;return{c(){t=b("Shows chunks as they complete (fastest feedback)")},m(e,n){u(e,t,n)},d(e){e&&m(t)}}}function St(e){let t,n,r,i=e[30].processingTime+"";return{c(){t=f("div"),n=b(i),r=b("ms"),_(t,"class","text-xs opacity-70")},m(e,i){u(e,t,i),d(t,n),d(t,r)},p(e,t){1&t[0]&&i!==(i=e[30].processingTime+"")&&v(n,i)},d(e){e&&m(t)}}}function Ct(e){let t,n,r,i,o,s,l,a,c,p,b=e[30].processingTime&&St(e);return{c(){t=f("div"),n=f("div"),r=f("iconify-icon"),o=g(),s=f("div"),s.textContent=\`\${e[32]}\`,l=g(),b&&b.c(),a=g(),y(r,"icon",i=Rt(e[30].status)),y(r,"class","text-sm"),_(s,"class","font-bold"),_(n,"class","flex flex-col items-center gap-1"),_(t,"class",c="border-2 p-2 text-center text-xs transition-all duration-300 "+Pt(e[30].status)),_(t,"title",p="Chunk "+e[32]+": "+e[30].status+(e[30].processingTime?\` (\${e[30].processingTime}ms)\`:""))},m(e,i){u(e,t,i),d(t,n),d(n,r),d(n,o),d(n,s),d(n,l),b&&b.m(n,null),d(t,a)},p(e,o){1&o[0]&&i!==(i=Rt(e[30].status))&&y(r,"icon",i),e[30].processingTime?b?b.p(e,o):(b=St(e),b.c(),b.m(n,null)):b&&(b.d(1),b=null),1&o[0]&&c!==(c="border-2 p-2 text-center text-xs transition-all duration-300 "+Pt(e[30].status))&&_(t,"class",c),1&o[0]&&p!==(p="Chunk "+e[32]+": "+e[30].status+(e[30].processingTime?\` (\${e[30].processingTime}ms)\`:""))&&_(t,"title",p)},d(e){e&&m(t),b&&b.d()}}}function Tt(e){let t,n,r,i,o,s,l,a,c,h,x=e[9].length+"",w=K(e[9]),k=[];for(let t=0;t<w.length;t+=1)k[t]=Ot(at(e,w,t));return{c(){t=f("div"),n=f("div"),r=f("iconify-icon"),i=b(" \\n              First to Complete\\n              "),o=f("span"),s=b("Arrival order • "),l=b(x),a=b(" chunks ready"),c=g(),h=f("div");for(let e=0;e<k.length;e+=1)k[e].c();y(r,"icon","mdi:flash"),y(r,"class","text-lg"),_(o,"class","text-xs text-terminal-text-dim ml-auto"),_(n,"class","p-3 border-b border-terminal-border font-bold text-terminal-accent flex items-center gap-2"),_(h,"class","p-4 max-h-80 overflow-y-auto space-y-3"),_(t,"class","border border-terminal-border bg-terminal-bg")},m(e,m){u(e,t,m),d(t,n),d(n,r),d(n,i),d(n,o),d(o,s),d(o,l),d(o,a),d(t,c),d(t,h);for(let e=0;e<k.length;e+=1)k[e]&&k[e].m(h,null)},p(e,t){if(512&t[0]&&x!==(x=e[9].length+"")&&v(l,x),512&t[0]){let n;for(w=K(e[9]),n=0;n<w.length;n+=1){const r=at(e,w,n);k[n]?k[n].p(r,t):(k[n]=Ot(r),k[n].c(),k[n].m(h,null))}for(;n<k.length;n+=1)k[n].d(1);k.length=w.length}},d(e){e&&m(t),p(k,e)}}}function Lt(e){let t,n,r,i,o=e[27].processingTime+"";return{c(){t=f("span"),n=b("("),r=b(o),i=b("ms)"),_(t,"class","text-xs text-terminal-text-dim")},m(e,o){u(e,t,o),d(t,n),d(t,r),d(t,i)},p(e,t){512&t[0]&&o!==(o=e[27].processingTime+"")&&v(r,o)},d(e){e&&m(t)}}}function Mt(e){let t,n,r=Bt(e[27].completedAt)+"";return{c(){t=f("span"),n=b(r),_(t,"class","text-xs text-blue-400 font-mono")},m(e,r){u(e,t,r),d(t,n)},p(e,t){512&t[0]&&r!==(r=Bt(e[27].completedAt)+"")&&v(n,r)},d(e){e&&m(t)}}}function Et(e){let t;return{c(){t=f("span"),t.textContent="LLM",_(t,"class","text-xs bg-purple-600 text-white px-2 py-1 rounded")},m(e,n){u(e,t,n)},d(e){e&&m(t)}}}function zt(e){let t,n,r,i,o,s,l,a=e[27].rawText+"";return{c(){t=f("div"),n=f("div"),n.textContent="Raw transcript:",r=g(),i=f("div"),o=b('"'),s=b(a),l=b('"'),_(n,"class","text-xs text-terminal-text-dim mb-1"),_(i,"class","text-sm font-mono whitespace-pre-wrap text-terminal-text-dim"),_(t,"class","mt-2 pt-2 border-t border-terminal-border")},m(e,a){u(e,t,a),d(t,n),d(t,r),d(t,i),d(i,o),d(i,s),d(i,l)},p(e,t){512&t[0]&&a!==(a=e[27].rawText+"")&&v(s,a)},d(e){e&&m(t)}}}function Ot(e){let t,n,r,i,o,s,l,a,c,p,h,x,y,w,k,$,j,S,C,T,L,M,E,z,O,A,F,D=e[27].chunkIndex+"",I=Jt(e[27].text,80)+"",U=e[27].text+"",P=e[27].processingTime&&Lt(e),R=e[27].completedAt&&Mt(e),N=e[27].llmApplied&&Et(),B=e[27].rawText&&e[27].text!==e[27].rawText&&zt(e);return{c(){t=f("div"),n=f("div"),r=f("div"),i=f("span"),o=b("Chunk "),s=b(D),l=g(),P&&P.c(),a=g(),R&&R.c(),c=g(),N&&N.c(),p=g(),h=f("details"),x=f("summary"),y=f("div"),w=f("span"),w.textContent="▶",k=g(),$=f("span"),j=b('"'),S=b(I),C=b('"'),T=g(),L=f("div"),M=f("div"),E=b('"'),z=b(U),O=b('"'),A=g(),B&&B.c(),F=g(),_(i,"class","font-bold text-green-800"),_(r,"class","flex items-center gap-2 mb-2"),_(w,"class","text-xs text-terminal-text-dim group-open:rotate-90 transition-transform"),_($,"class","italic"),_(y,"class","flex items-center gap-2"),_(x,"class","cursor-pointer text-sm font-mono text-terminal-text hover:text-terminal-accent transition-colors list-none"),_(M,"class","text-sm font-mono whitespace-pre-wrap text-terminal-text"),_(L,"class","mt-3 pl-4 border-l-2 border-green-800/30"),_(h,"class","group"),_(n,"class","p-3"),_(t,"class","border border-green-800 bg-green-900/10 rounded")},m(e,m){u(e,t,m),d(t,n),d(n,r),d(r,i),d(i,o),d(i,s),d(r,l),P&&P.m(r,null),d(r,a),R&&R.m(r,null),d(r,c),N&&N.m(r,null),d(n,p),d(n,h),d(h,x),d(x,y),d(y,w),d(y,k),d(y,$),d($,j),d($,S),d($,C),d(h,T),d(h,L),d(L,M),d(M,E),d(M,z),d(M,O),d(L,A),B&&B.m(L,null),d(t,F)},p(e,t){512&t[0]&&D!==(D=e[27].chunkIndex+"")&&v(s,D),e[27].processingTime?P?P.p(e,t):(P=Lt(e),P.c(),P.m(r,a)):P&&(P.d(1),P=null),e[27].completedAt?R?R.p(e,t):(R=Mt(e),R.c(),R.m(r,c)):R&&(R.d(1),R=null),e[27].llmApplied?N||(N=Et(),N.c(),N.m(r,null)):N&&(N.d(1),N=null),512&t[0]&&I!==(I=Jt(e[27].text,80)+"")&&v(S,I),512&t[0]&&U!==(U=e[27].text+"")&&v(z,U),e[27].rawText&&e[27].text!==e[27].rawText?B?B.p(e,t):(B=zt(e),B.c(),B.m(L,null)):B&&(B.d(1),B=null)},d(e){e&&m(t),P&&P.d(),R&&R.d(),N&&N.d(),B&&B.d()}}}function At(e){let t;return{c(){t=b("Readable Transcript (In Order)")},m(e,n){u(e,t,n)},d(e){e&&m(t)}}}function Ft(e){let t;return{c(){t=b("Readable Transcript (Ordered)")},m(e,n){u(e,t,n)},d(e){e&&m(t)}}}function Dt(t){let n;return{c(){n=f("div"),n.textContent="Waiting for chunks to complete in order...",_(n,"class","text-terminal-text-dim italic")},m(e,t){u(e,n,t)},p:e,d(e){e&&m(n)}}}function It(e){let t,n;return{c(){t=f("pre"),n=b(e[2]),_(t,"class","whitespace-pre-wrap")},m(e,r){u(e,t,r),d(t,n)},p(e,t){4&t[0]&&v(n,e[2])},d(e){e&&m(t)}}}function Ut(t){let n,r=(t[7]||t[5]||t[6]||t[4])&&dt(t);return{c(){r&&r.c(),n=h()},m(e,t){r&&r.m(e,t),u(e,n,t)},p(e,t){e[7]||e[5]||e[6]||e[4]?r?r.p(e,t):(r=dt(e),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},i:e,o:e,d(e){e&&m(n),r&&r.d(e)}}}function Pt(e){switch(e){case"pending":default:return"border-terminal-border bg-terminal-bg";case"uploading":return"border-blue-400 bg-blue-900/20 animate-pulse";case"processing":return"border-yellow-400 bg-yellow-900/20 animate-pulse";case"complete":return"border-green-400 bg-green-900/20";case"failed":return"border-red-400 bg-red-900/20"}}function Rt(e){switch(e){case"pending":default:return"mdi:circle-outline";case"uploading":return"mdi:upload";case"processing":return"mdi:cog";case"complete":return"mdi:check-circle";case"failed":return"mdi:alert-circle"}}function Nt(e){return\`\${Math.floor(e/60)}:\${(e%60).toString().padStart(2,"0")}\`}function Bt(e){if(!e)return"";const t=new Date(e);return\`\${t.getHours().toString().padStart(2,"0")}:\${t.getMinutes().toString().padStart(2,"0")}:\${t.getSeconds().toString().padStart(2,"0")}.\${t.getMilliseconds().toString().padStart(3,"0")}\`}function Jt(e,t=100){if(!e)return"";const n=e.match(/^[^.!?]*[.!?]/);if(n&&n[0].length<=t)return n[0].trim();if(e.length<=t)return e;const r=e.substring(0,t),i=r.lastIndexOf(" ");return i>.7*t?r.substring(0,i)+"...":r+"..."}function Wt(e,t,n){let r,i,o,s,l,d,u,m,p,f,b,g,h,x,_,y,v,w,k,$,j,S;a(e,je,e=>n(0,r=e)),a(e,Se,e=>n(1,i=e)),a(e,Te,e=>n(2,o=e)),a(e,he,e=>n(3,s=e)),a(e,be,e=>n(24,l=e)),a(e,ke,e=>n(4,d=e)),a(e,pe,e=>n(5,u=e)),a(e,we,e=>n(6,m=e)),a(e,me,e=>n(7,p=e)),a(e,Le,e=>n(10,f=e)),a(e,fe,e=>n(11,b=e)),a(e,Ce,e=>n(12,g=e)),a(e,Ee,e=>n(13,h=e)),a(e,Me,e=>n(14,x=e)),a(e,ze,e=>n(15,_=e)),a(e,Oe,e=>n(16,y=e)),a(e,Ae,e=>n(17,v=e)),a(e,ge,e=>n(18,w=e)),a(e,xe,e=>n(19,k=e)),a(e,_e,e=>n(20,$=e)),a(e,ye,e=>n(21,j=e)),a(e,ve,e=>n(22,S=e));let C=0,T=null,L=[];return e.$$.update=()=>{25166064&e.$$.dirty[0]&&(!p&&!m||T?p||m||!T||(clearInterval(T),n(23,T=null),(u||d)&&n(8,C=Math.floor((Date.now()-l)/1e3))):n(23,T=setInterval(()=>{n(8,C=Math.floor((Date.now()-l)/1e3))},1e3))),8&e.$$.dirty[0]&&s&&setTimeout(()=>{const e=document.getElementById("streaming-transcript");e&&(e.scrollTop=e.scrollHeight)},50),4&e.$$.dirty[0]&&o&&setTimeout(()=>{const e=document.getElementById("chunked-readable-transcript");e&&(e.scrollTop=e.scrollHeight)},50),3&e.$$.dirty[0]&&n(9,L="speed"===i?r.filter(e=>e&&"complete"===e.status).sort((e,t)=>(e.arrivalOrder||0)-(t.arrivalOrder||0)):r.filter(e=>e&&"complete"===e.status).slice(0,function(e){for(let t=0;t<e.length;t++)if(!e[t]||"complete"!==e[t].status)return t-1;return e.length-1}(r)+1))},[r,i,o,s,d,u,m,p,C,L,f,b,g,h,x,_,y,v,w,k,$,j,S,T,l,()=>c(Se,i="speed",i),()=>c(Se,i="order",i)]}class Gt extends ne{constructor(e){super(),te(this,e,Wt,Ut,o,{},null,[-1,-1])}}function Ht(t){let n,r,i,o,s,l,a,c;return i=new qe({}),s=new lt({}),a=new Gt({}),{c(){n=f("div"),r=f("div"),Q(i.$$.fragment),o=g(),Q(s.$$.fragment),l=g(),Q(a.$$.fragment),_(r,"class","grid grid-cols-1 lg:grid-cols-2 gap-4"),_(n,"class","border-2 border-terminal-border bg-terminal-bg-light p-4 mb-4")},m(e,t){u(e,n,t),d(n,r),Y(i,r,null),d(r,o),Y(s,r,null),u(e,l,t),Y(a,e,t),c=!0},p:e,i(e){c||(q(i.$$.fragment,e),q(s.$$.fragment,e),q(a.$$.fragment,e),c=!0)},o(e){V(i.$$.fragment,e),V(s.$$.fragment,e),V(a.$$.fragment,e),c=!1},d(e){e&&(m(n),m(l)),Z(i),Z(s),Z(a,e)}}}function qt(e){return E(),[]}class Vt extends ne{constructor(e){super(),te(this,e,qt,Ht,o,{})}}function Kt(e){let t;return{c(){t=f("span"),t.textContent="URL",_(t,"class","text-status-info text-xs bg-blue-900/30 px-1 rounded")},m(e,n){u(e,t,n)},d(e){e&&m(t)}}}function Xt(e){let t;return{c(){t=f("span"),t.textContent="Streamed",_(t,"class","text-status-info text-xs bg-blue-900/30 px-1 rounded")},m(e,n){u(e,t,n)},d(e){e&&m(t)}}}function Qt(e){let t,n,r,i,o,s=e[0].total_segments+"";return{c(){t=f("span"),n=f("iconify-icon"),r=g(),i=b(s),o=b(" segments"),y(n,"icon","mdi:format-list-numbered"),y(n,"class","text-xs")},m(e,s){u(e,t,s),d(t,n),d(t,r),d(t,i),d(t,o)},p(e,t){1&t&&s!==(s=e[0].total_segments+"")&&v(i,s)},d(e){e&&m(t)}}}function Yt(e){let t,n,r,i,o=(e[0].progress||0)+"";return{c(){t=f("div"),n=f("div"),r=b(o),i=b("%"),_(n,"class","bg-terminal-accent h-full flex items-center justify-center text-terminal-bg text-xs font-bold transition-all duration-300"),k(n,"width",(e[0].progress||0)+"%"),_(t,"class","bg-terminal-bg border border-terminal-border h-5 overflow-hidden mt-2")},m(e,o){u(e,t,o),d(t,n),d(n,r),d(n,i)},p(e,t){1&t&&o!==(o=(e[0].progress||0)+"")&&v(r,o),1&t&&k(n,"width",(e[0].progress||0)+"%")},d(e){e&&m(t)}}}function Zt(e){let t;return{c(){t=f("span"),t.innerHTML='<iconify-icon icon="mdi:brain" class="text-xs"></iconify-icon> LLM Enhanced',_(t,"class","text-terminal-accent")},m(e,n){u(e,t,n)},d(e){e&&m(t)}}}function en(e){let t,n,r,i,o=e[0].error+"";return{c(){t=f("span"),n=f("iconify-icon"),r=b(" \\n          Error: "),i=b(o),y(n,"icon","mdi:alert-circle"),y(n,"class","text-xs"),_(t,"class","text-status-error")},m(e,o){u(e,t,o),d(t,n),d(t,r),d(t,i)},p(e,t){1&t&&o!==(o=e[0].error+"")&&v(i,o)},d(e){e&&m(t)}}}function tn(e){let t;function n(e,t){return"done"===e[0].status?rn:nn}let r=n(e),i=r(e);return{c(){t=f("div"),i.c(),_(t,"class","border-t border-terminal-border bg-gray-900/5 p-3")},m(e,n){u(e,t,n),i.m(t,null)},p(e,o){r===(r=n(e))&&i?i.p(e,o):(i.d(1),i=r(e),i&&(i.c(),i.m(t,null)))},d(e){e&&m(t),i.d()}}}function nn(e){let t,n,r,i,o,s,l,a,c,p,h,x,y,w,k,$,j,S,C,T,L,M,E,z,O,A,F,D,I,U,P,R,N,B=e[0].job_id+"",J=e[0].status+"",W=(e[0].upload_method||"direct")+"",G=(e[0].processing_method||"direct")+"",H=(e[0].use_llm?e[0].llm_mode||"enabled":"disabled")+"",q=De(e[0].file_size||0)+"",V=e[0].chunk_size_mb&&on(e);return{c(){t=f("div"),n=f("div"),r=f("div"),r.textContent="Job Details",i=g(),o=f("div"),s=f("div"),l=b("ID: "),a=b(B),c=g(),p=f("div"),h=b("Status: "),x=b(J),y=g(),w=f("div"),k=b("Upload: "),$=b(W),j=g(),S=f("div"),C=b("Processing: "),T=b(G),L=g(),M=f("div"),E=f("div"),E.textContent="Settings",z=g(),O=f("div"),A=f("div"),F=b("LLM: "),D=b(H),I=g(),V&&V.c(),U=g(),P=f("div"),R=b("File Size: "),N=b(q),_(r,"class","text-terminal-accent font-bold mb-2"),_(o,"class","space-y-1 text-xs text-terminal-text-dim"),_(E,"class","text-terminal-accent font-bold mb-2"),_(O,"class","space-y-1 text-xs text-terminal-text-dim"),_(t,"class","grid grid-cols-1 md:grid-cols-2 gap-4")},m(e,m){u(e,t,m),d(t,n),d(n,r),d(n,i),d(n,o),d(o,s),d(s,l),d(s,a),d(o,c),d(o,p),d(p,h),d(p,x),d(o,y),d(o,w),d(w,k),d(w,$),d(o,j),d(o,S),d(S,C),d(S,T),d(t,L),d(t,M),d(M,E),d(M,z),d(M,O),d(O,A),d(A,F),d(A,D),d(O,I),V&&V.m(O,null),d(O,U),d(O,P),d(P,R),d(P,N)},p(e,t){1&t&&B!==(B=e[0].job_id+"")&&v(a,B),1&t&&J!==(J=e[0].status+"")&&v(x,J),1&t&&W!==(W=(e[0].upload_method||"direct")+"")&&v($,W),1&t&&G!==(G=(e[0].processing_method||"direct")+"")&&v(T,G),1&t&&H!==(H=(e[0].use_llm?e[0].llm_mode||"enabled":"disabled")+"")&&v(D,H),e[0].chunk_size_mb?V?V.p(e,t):(V=on(e),V.c(),V.m(O,U)):V&&(V.d(1),V=null),1&t&&q!==(q=De(e[0].file_size||0)+"")&&v(N,q)},d(e){e&&m(t),V&&V.d()}}}function rn(e){let t,n,i,o,s,l,a,c,p,h,w,k,$,j,S,C,T,L,M,E,z,O,A,F,D,I,U,P,R,N,B,J,W,G,H,q,V,K,X,Q=e[0].job_id+"",Y=e[0].status+"",Z=(e[0].processing_method||"direct")+"",ee=e[2]?"Copied!":"Copy Transcript",te=e[0].total_segments>0&&sn(e);function ne(e,t){return"streaming"===e[0].processing_method?an:ln}let re=ne(e),ie=re(e);function oe(e,t){return"streaming"===e[0].processing_method?dn:cn}let se=oe(e),le=se(e);return{c(){t=f("div"),n=f("div"),i=f("div"),i.textContent="Job Details",o=g(),s=f("div"),l=f("div"),a=b("ID: "),c=b(Q),p=g(),h=f("div"),w=b("Status: "),k=b(Y),$=g(),j=f("div"),S=b("Method: "),C=b(Z),T=g(),te&&te.c(),L=g(),M=f("div"),M.textContent="Actions",E=g(),z=f("div"),O=f("button"),A=f("iconify-icon"),F=g(),D=b(ee),I=g(),U=f("button"),U.innerHTML='<iconify-icon icon="mdi:code-json" class="text-xs"></iconify-icon> Copy JSON',P=g(),R=f("div"),N=f("div"),N.textContent="Full Transcript",B=g(),J=f("div"),W=f("div"),G=f("iconify-icon"),H=g(),ie.c(),q=g(),V=f("div"),le.c(),_(i,"class","text-terminal-accent font-bold mb-2"),_(s,"class","space-y-1 text-xs text-terminal-text-dim mb-4"),_(M,"class","text-terminal-accent font-bold mb-2"),y(A,"icon","mdi:content-copy"),y(A,"class","text-xs"),O.disabled=e[2],_(O,"class","bg-terminal-bg-light border border-terminal-border text-terminal-text px-2 py-1 text-xs hover:bg-gray-700 transition-colors flex items-center gap-1 w-full"),_(U,"class","bg-terminal-bg-light border border-terminal-border text-terminal-text px-2 py-1 text-xs hover:bg-gray-700 transition-colors flex items-center gap-1 w-full"),_(z,"class","space-y-2"),_(n,"class","lg:col-span-1 flex flex-col"),_(N,"class","text-terminal-accent font-bold mb-2"),y(G,"icon","mdi:text-box"),y(G,"class","text-sm"),_(W,"class","p-3 border-b border-terminal-border font-bold text-terminal-text-dim text-xs flex-shrink-0"),_(V,"class","p-4 flex-1 overflow-y-auto font-mono text-sm leading-relaxed min-h-[16rem]"),_(J,"class","border border-terminal-border bg-terminal-bg flex flex-col flex-1 min-h-0"),_(R,"class","lg:col-span-2 flex flex-col"),_(t,"class","grid grid-cols-1 lg:grid-cols-3 gap-4 lg:items-start")},m(r,m){u(r,t,m),d(t,n),d(n,i),d(n,o),d(n,s),d(s,l),d(l,a),d(l,c),d(s,p),d(s,h),d(h,w),d(h,k),d(s,$),d(s,j),d(j,S),d(j,C),d(s,T),te&&te.m(s,null),d(n,L),d(n,M),d(n,E),d(n,z),d(z,O),d(O,A),d(O,F),d(O,D),d(z,I),d(z,U),d(t,P),d(t,R),d(R,N),d(R,B),d(R,J),d(J,W),d(W,G),d(W,H),ie.m(W,null),d(J,q),d(J,V),le.m(V,null),K||(X=[x(O,"click",e[9]),x(U,"click",e[10])],K=!0)},p(e,t){1&t&&Q!==(Q=e[0].job_id+"")&&v(c,Q),1&t&&Y!==(Y=e[0].status+"")&&v(k,Y),1&t&&Z!==(Z=(e[0].processing_method||"direct")+"")&&v(C,Z),e[0].total_segments>0?te?te.p(e,t):(te=sn(e),te.c(),te.m(s,null)):te&&(te.d(1),te=null),4&t&&ee!==(ee=e[2]?"Copied!":"Copy Transcript")&&v(D,ee),4&t&&(O.disabled=e[2]),re!==(re=ne(e))&&(ie.d(1),ie=re(e),ie&&(ie.c(),ie.m(W,null))),se===(se=oe(e))&&le?le.p(e,t):(le.d(1),le=se(e),le&&(le.c(),le.m(V,null)))},d(e){e&&m(t),te&&te.d(),ie.d(),le.d(),K=!1,r(X)}}}function on(e){let t,n,r,i,o=e[0].chunk_size_mb+"";return{c(){t=f("div"),n=b("Chunk Size: "),r=b(o),i=b("MB")},m(e,o){u(e,t,o),d(t,n),d(t,r),d(t,i)},p(e,t){1&t&&o!==(o=e[0].chunk_size_mb+"")&&v(r,o)},d(e){e&&m(t)}}}function sn(e){let t,n,r,i=e[0].total_segments+"";return{c(){t=f("div"),n=b("Segments: "),r=b(i)},m(e,i){u(e,t,i),d(t,n),d(t,r)},p(e,t){1&t&&i!==(i=e[0].total_segments+"")&&v(r,i)},d(e){e&&m(t)}}}function ln(e){let t;return{c(){t=b("Final Transcript")},m(e,n){u(e,t,n)},d(e){e&&m(t)}}}function an(e){let t;return{c(){t=b("Final Transcript (Streaming)")},m(e,n){u(e,t,n)},d(e){e&&m(t)}}}function cn(e){let t;function n(e,t){return e[4]?fn:e[5]&&e[3]?pn:e[5]?mn:un}let r=n(e),i=r(e);return{c(){i.c(),t=h()},m(e,n){i.m(e,n),u(e,t,n)},p(e,o){r===(r=n(e))&&i?i.p(e,o):(i.d(1),i=r(e),i&&(i.c(),i.m(t.parentNode,t)))},d(e){e&&m(t),i.d(e)}}}function dn(e){let t;function n(e,t){return e[0].final_transcript?xn:e[0].corrected_transcript?hn:e[0].raw_transcript?gn:bn}let r=n(e),i=r(e);return{c(){i.c(),t=h()},m(e,n){i.m(e,n),u(e,t,n)},p(e,o){r===(r=n(e))&&i?i.p(e,o):(i.d(1),i=r(e),i&&(i.c(),i.m(t.parentNode,t)))},d(e){e&&m(t),i.d(e)}}}function un(t){let n;return{c(){n=f("div"),n.textContent="Transcript will load when expanded",_(n,"class","text-terminal-text-dim italic")},m(e,t){u(e,n,t)},p:e,d(e){e&&m(n)}}}function mn(t){let n;return{c(){n=f("div"),n.textContent="No transcript available",_(n,"class","text-terminal-text-dim italic")},m(e,t){u(e,n,t)},p:e,d(e){e&&m(n)}}}function pn(e){let t,n;return{c(){t=f("pre"),n=b(e[3]),_(t,"class","whitespace-pre-wrap text-terminal-text")},m(e,r){u(e,t,r),d(t,n)},p(e,t){8&t&&v(n,e[3])},d(e){e&&m(t)}}}function fn(t){let n;return{c(){n=f("div"),n.innerHTML='<iconify-icon icon="mdi:loading" class="animate-spin"></iconify-icon>\\n                       Loading transcript...',_(n,"class","text-terminal-text-dim italic flex items-center gap-2")},m(e,t){u(e,n,t)},p:e,d(e){e&&m(n)}}}function bn(t){let n;return{c(){n=f("div"),n.textContent="No transcript available",_(n,"class","text-terminal-text-dim italic")},m(e,t){u(e,n,t)},p:e,d(e){e&&m(n)}}}function gn(e){let t,n,r=e[0].raw_transcript+"";return{c(){t=f("pre"),n=b(r),_(t,"class","whitespace-pre-wrap text-terminal-text")},m(e,r){u(e,t,r),d(t,n)},p(e,t){1&t&&r!==(r=e[0].raw_transcript+"")&&v(n,r)},d(e){e&&m(t)}}}function hn(e){let t,n,r=e[0].corrected_transcript+"";return{c(){t=f("pre"),n=b(r),_(t,"class","whitespace-pre-wrap text-terminal-text")},m(e,r){u(e,t,r),d(t,n)},p(e,t){1&t&&r!==(r=e[0].corrected_transcript+"")&&v(n,r)},d(e){e&&m(t)}}}function xn(e){let t,n,r=e[0].final_transcript+"";return{c(){t=f("pre"),n=b(r),_(t,"class","whitespace-pre-wrap text-terminal-text")},m(e,r){u(e,t,r),d(t,n)},p(e,t){1&t&&r!==(r=e[0].final_transcript+"")&&v(n,r)},d(e){e&&m(t)}}}function _n(t){let n,i,o,s,l,a,c,p,h,w,k,$,j,C,T,L,M,E,z,O,A,F,D,I,U,P,R,N,B,J,W,G,H,q,V,K,X,Q,Y,Z,ee,te,ne,re,ie,oe,se,le,ae,ce,de,ue=(t[0].filename||"Unknown")+"",me=t[0].job_id.slice(0,8)+"",pe=De(t[0].file_size||0)+"",fe=(t[0].processing_method||"direct")+"",be=yn(t[0])+"",ge=new Date(t[0].created_at).toLocaleString()+"",he="url"===t[0].upload_method&&Kt(),xe="streaming"===t[0].upload_method&&Xt(),_e=t[0].total_segments>0&&Qt(t),ye=void 0!==t[0].progress&&("processing"===t[0].status||"uploaded"===t[0].status)&&Yt(t),ve=t[0].use_llm&&Zt(),we=t[0].error&&en(t),ke=t[1]&&tn(t);return{c(){n=f("div"),i=f("div"),o=f("div"),s=f("div"),l=f("div"),a=f("iconify-icon"),c=g(),p=f("span"),h=b(ue),w=g(),he&&he.c(),k=g(),xe&&xe.c(),$=g(),j=f("div"),C=f("span"),T=f("iconify-icon"),L=g(),M=b(me),E=b("..."),z=g(),O=f("span"),A=f("iconify-icon"),F=g(),D=b(pe),I=g(),U=f("span"),P=f("iconify-icon"),R=g(),N=b(fe),B=g(),_e&&_e.c(),J=g(),W=f("div"),G=f("div"),H=f("iconify-icon"),V=g(),K=b(be),Q=g(),Y=f("button"),Y.innerHTML='<iconify-icon icon="mdi:delete" class="text-lg"></iconify-icon>',Z=g(),ye&&ye.c(),ee=g(),te=f("div"),ne=f("span"),re=f("iconify-icon"),ie=g(),oe=b(ge),se=g(),ve&&ve.c(),le=g(),we&&we.c(),ae=g(),ke&&ke.c(),y(a,"icon","mdi:file-music"),y(a,"class","text-terminal-accent"),_(p,"class","font-bold"),_(l,"class","flex items-center gap-2 mb-1"),y(T,"icon","mdi:identifier"),y(T,"class","text-xs"),y(A,"icon","mdi:file-outline"),y(A,"class","text-xs"),y(P,"icon","mdi:cog"),y(P,"class","text-xs"),_(j,"class","flex flex-wrap gap-3 text-xs text-terminal-text-dim"),_(s,"class","flex-1 min-w-0"),y(H,"icon",q=t[7](t[0].status)),y(H,"class","text-xs"),S(H,"animate-spin","processing"===t[0].status||"uploaded"===t[0].status),_(G,"class",X="px-2 py-1 text-xs font-bold uppercase "+t[6](t[0].status)+" flex items-center gap-1"),_(Y,"class","text-status-error hover:bg-status-error hover:text-terminal-bg transition-colors p-1 rounded flex items-center justify-center"),_(Y,"title","Delete job"),_(W,"class","flex items-center gap-2 flex-shrink-0"),_(o,"class","flex items-start gap-3"),y(re,"icon","mdi:clock-outline"),y(re,"class","text-xs"),_(te,"class","mt-2 flex flex-wrap gap-3 text-xs text-terminal-text-dim"),_(i,"class","p-3 pr-4 hover:bg-gray-800/5 transition-colors cursor-pointer"),_(i,"role","button"),_(i,"tabindex","0"),_(n,"class","border-b border-terminal-border")},m(e,r){var m;u(e,n,r),d(n,i),d(i,o),d(o,s),d(s,l),d(l,a),d(l,c),d(l,p),d(p,h),d(l,w),he&&he.m(l,null),d(l,k),xe&&xe.m(l,null),d(s,$),d(s,j),d(j,C),d(C,T),d(C,L),d(C,M),d(C,E),d(j,z),d(j,O),d(O,A),d(O,F),d(O,D),d(j,I),d(j,U),d(U,P),d(U,R),d(U,N),d(j,B),_e&&_e.m(j,null),d(o,J),d(o,W),d(W,G),d(G,H),d(G,V),d(G,K),d(W,Q),d(W,Y),d(i,Z),ye&&ye.m(i,null),d(i,ee),d(i,te),d(te,ne),d(ne,re),d(ne,ie),d(ne,oe),d(te,se),ve&&ve.m(te,null),d(te,le),we&&we.m(te,null),d(n,ae),ke&&ke.m(n,null),ce||(de=[x(Y,"click",(m=t[8],function(e){return e.stopPropagation(),m.call(this,e)})),x(i,"click",t[11]),x(i,"keydown",t[12])],ce=!0)},p(e,[t]){1&t&&ue!==(ue=(e[0].filename||"Unknown")+"")&&v(h,ue),"url"===e[0].upload_method?he||(he=Kt(),he.c(),he.m(l,k)):he&&(he.d(1),he=null),"streaming"===e[0].upload_method?xe||(xe=Xt(),xe.c(),xe.m(l,null)):xe&&(xe.d(1),xe=null),1&t&&me!==(me=e[0].job_id.slice(0,8)+"")&&v(M,me),1&t&&pe!==(pe=De(e[0].file_size||0)+"")&&v(D,pe),1&t&&fe!==(fe=(e[0].processing_method||"direct")+"")&&v(N,fe),e[0].total_segments>0?_e?_e.p(e,t):(_e=Qt(e),_e.c(),_e.m(j,null)):_e&&(_e.d(1),_e=null),1&t&&q!==(q=e[7](e[0].status))&&y(H,"icon",q),1&t&&S(H,"animate-spin","processing"===e[0].status||"uploaded"===e[0].status),1&t&&be!==(be=yn(e[0])+"")&&v(K,be),1&t&&X!==(X="px-2 py-1 text-xs font-bold uppercase "+e[6](e[0].status)+" flex items-center gap-1")&&_(G,"class",X),void 0===e[0].progress||"processing"!==e[0].status&&"uploaded"!==e[0].status?ye&&(ye.d(1),ye=null):ye?ye.p(e,t):(ye=Yt(e),ye.c(),ye.m(i,ee)),1&t&&ge!==(ge=new Date(e[0].created_at).toLocaleString()+"")&&v(oe,ge),e[0].use_llm?ve||(ve=Zt(),ve.c(),ve.m(te,le)):ve&&(ve.d(1),ve=null),e[0].error?we?we.p(e,t):(we=en(e),we.c(),we.m(te,null)):we&&(we.d(1),we=null),e[1]?ke?ke.p(e,t):(ke=tn(e),ke.c(),ke.m(n,null)):ke&&(ke.d(1),ke=null)},i:e,o:e,d(e){e&&m(n),he&&he.d(),xe&&xe.d(),_e&&_e.d(),ye&&ye.d(),ve&&ve.d(),we&&we.d(),ke&&ke.d(),ce=!1,r(de)}}}function yn(e){return e.status?"processing"===e.status||"uploaded"===e.status?"streaming"===e.processing_method?"STREAMING":"PROCESSING":"done"===e.status?"COMPLETED":e.status.toUpperCase():"UNKNOWN"}function vn(e,t,n){let{job:r}=t,i=!1,o=!1,s="",a=!1,c=!1;const d={processing:"bg-status-info text-terminal-bg",uploaded:"bg-status-info text-terminal-bg",failed:"bg-status-error text-terminal-bg",done:"bg-status-success text-terminal-bg",unknown:"bg-status-warning text-terminal-bg"},u={processing:"mdi:sync",uploaded:"mdi:sync",failed:"mdi:alert-circle",done:"mdi:check-circle",unknown:"mdi:help-circle"};function m(){n(1,i=!i),i&&"done"===r.status&&"streaming"!==r.processing_method&&async function(){if(!a&&!c&&"streaming"!==r.processing_method){n(4,a=!0);try{const e=await fetch(\`/result?job_id=\${r.job_id}\`);if(e.ok){const t=await e.json();n(3,s=t.final||"No transcript available"),n(5,c=!0)}else n(3,s="Failed to fetch transcript")}catch(e){n(3,s="Error loading transcript: "+e.message)}finally{n(4,a=!1)}}}()}return e.$$set=e=>{"job"in e&&n(0,r=e.job)},[r,i,o,s,a,c,function(e){return d[e?.toLowerCase()]||"bg-status-warning text-terminal-bg"},function(e){return u[e?.toLowerCase()]||"mdi:clock"},async function(){if(confirm("Are you sure you want to delete this job?"))try{await async function(e){const t=l(de),n=t.find(t=>t.job_id===e);if(!n)throw new Error("Job not found");const r=t.length;if("streaming"===n.processing_method){console.log("Deleting streaming job locally and from server");const n=t.filter(t=>t.job_id!==e);return de.set(n),fetch("/delete-job",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({job_id:e})}).then(t=>{t.ok?ae.info("delete","Also deleted streaming job from server KV",{job_id:e}):ae.debug("Streaming job not found on server (local only)",{job_id:e})}).catch(t=>{ae.debug("Error deleting streaming job from server (likely local only)",{job_id:e,error:t.message})}),console.log("Jobs after streaming deletion:",n.length,"removed:",r-n.length),void ae.info("delete","Deleted streaming job locally",{job_id:e,count_before:r,count_after:n.length})}const i=await fetch("/delete-job",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({job_id:e})});if(!i.ok){const e=await i.json();throw console.error("Server deletion failed:",e),new Error(e.error||"Delete failed")}{console.log("Server deletion successful, removing from local array");const n=t.filter(t=>t.job_id!==e);de.set(n),console.log("Jobs after server deletion:",n.length,"removed:",r-n.length),ae.info("delete","Deleted server job",{job_id:e,count_before:r,count_after:n.length})}}(r.job_id)}catch(e){alert("Failed to delete job: "+e.message)}},async function(){if(!o){n(2,o=!0);try{await async function(e){const t=l(de).find(t=>t.job_id===e);if(!t)throw new Error("Job not found");let n="";if("streaming"===t.processing_method)n=t.final_transcript||t.corrected_transcript||t.raw_transcript||"No transcript available";else{const t=await fetch("/result?job_id="+e);n=t.ok?(await t.json()).final||"No transcript available":"Failed to fetch transcript"}return await navigator.clipboard.writeText(n),n}(r.job_id),setTimeout(()=>n(2,o=!1),2e3)}catch(e){alert("Failed to copy transcript: "+e.message),n(2,o=!1)}}},async function(){try{await async function(e){const t=l(de).find(t=>t.job_id===e);if(!t)throw new Error("Job not found");let n={...t};if("streaming"!==t.processing_method)try{const t=await fetch("/result?job_id="+e);if(t.ok){const e=await t.json();n.transcript_data=e}}catch(e){ae.warn("Could not fetch full transcript data for JSON export",e)}const r=JSON.stringify(n,null,2);return await navigator.clipboard.writeText(r),r}(r.job_id)}catch(e){alert("Failed to copy job JSON: "+e.message)}},m,e=>"Enter"===e.key&&m()]}class wn extends ne{constructor(e){super(),te(this,e,vn,_n,o,{job:0})}}function kn(e,t,n){const r=e.slice();return r[8]=t[n],r}function $n(e){let t,n,r,i=e[1].filter(Ln).length+"";return{c(){t=f("span"),n=b(i),r=b(" Running"),_(t,"class","text-xs bg-status-info text-terminal-bg px-2 py-1 rounded")},m(e,i){u(e,t,i),d(t,n),d(t,r)},p(e,t){2&t&&i!==(i=e[1].filter(Ln).length+"")&&v(n,i)},d(e){e&&m(t)}}}function jn(e){let t,n,i=[],o=new Map,s=K(e[1]);const l=e=>e[8].job_id;for(let t=0;t<s.length;t+=1){let n=kn(e,s,t),r=l(n);o.set(r,i[t]=Cn(r,n))}return{c(){t=f("div");for(let e=0;e<i.length;e+=1)i[e].c();_(t,"class","border border-x-2 border-terminal-border")},m(e,r){u(e,t,r);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,null);n=!0},p(e,n){2&n&&(s=K(e[1]),G(),i=function(e,t,n,i,o,s,l,a,c,d,u,m){let p=e.length,f=s.length,b=p;const g={};for(;b--;)g[e[b].key]=b;const h=[],x=new Map,_=new Map,y=[];for(b=f;b--;){const e=m(o,s,b),r=n(e);let i=l.get(r);i?y.push(()=>i.p(e,t)):(i=d(r,e),i.c()),x.set(r,h[b]=i),r in g&&_.set(r,Math.abs(b-g[r]))}const v=new Set,w=new Set;function k(e){q(e,1),e.m(a,u),l.set(e.key,e),u=e.first,f--}for(;p&&f;){const t=h[f-1],n=e[p-1],r=t.key,i=n.key;t===n?(u=t.first,p--,f--):x.has(i)?!l.has(r)||v.has(r)?k(t):w.has(i)?p--:_.get(r)>_.get(i)?(w.add(r),k(t)):(v.add(i),p--):(c(n,l),p--)}for(;p--;){const t=e[p];x.has(t.key)||c(t,l)}for(;f;)k(h[f-1]);return r(y),h}(i,n,l,0,e,s,o,t,X,Cn,null,kn),H())},i(e){if(!n){for(let e=0;e<s.length;e+=1)q(i[e]);n=!0}},o(e){for(let e=0;e<i.length;e+=1)V(i[e]);n=!1},d(e){e&&m(t);for(let e=0;e<i.length;e+=1)i[e].d()}}}function Sn(t){let n;return{c(){n=f("div"),n.textContent="No jobs yet",_(n,"class","py-10 px-5 text-center text-terminal-text-dim")},m(e,t){u(e,n,t)},p:e,i:e,o:e,d(e){e&&m(n)}}}function Cn(e,t){let n,r,i;return r=new wn({props:{job:t[8]}}),{key:e,first:null,c(){n=h(),Q(r.$$.fragment),this.first=n},m(e,t){u(e,n,t),Y(r,e,t),i=!0},p(e,n){t=e;const i={};2&n&&(i.job=t[8]),r.$set(i)},i(e){i||(q(r.$$.fragment,e),i=!0)},o(e){V(r.$$.fragment,e),i=!1},d(e){e&&m(n),Z(r,e)}}}function Tn(e){let t,n,i,o,s,l,a,c,p,h,w,k,$,j,C,T,L,M,E,z,O,A,F,D,I,U,P=e[1].length+"",R=e[2]?"Refreshing...":"Refresh",N=e[0]&&$n(e);const B=[Sn,jn],J=[];function W(e,t){return 0===e[1].length?0:1}return A=W(e),F=J[A]=B[A](e),{c(){t=f("div"),n=f("div"),i=f("div"),o=f("span"),s=b("Jobs ("),l=b(P),a=b(")"),c=g(),N&&N.c(),p=g(),h=f("div"),w=f("button"),k=f("iconify-icon"),$=b("\\n        Delete All"),C=g(),T=f("button"),L=f("iconify-icon"),E=g(),z=b(R),O=g(),F.c(),_(o,"class","font-bold"),_(i,"class","flex items-center gap-2"),y(k,"icon","mdi:delete-sweep"),y(k,"class","text-sm"),w.disabled=j=0===e[1].length,_(w,"class","bg-terminal-bg-light border border-terminal-border text-status-error px-3 py-1 text-xs hover:bg-red-900/30 transition-colors flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed"),y(L,"icon",M=e[2]?"mdi:loading":"mdi:refresh"),y(L,"class","text-sm"),S(L,"animate-spin",e[2]),T.disabled=e[2],_(T,"class","bg-terminal-bg-light border border-terminal-border text-terminal-text px-3 py-1 text-xs hover:bg-gray-700 transition-colors flex items-center gap-1"),_(h,"class","flex items-center gap-2"),_(n,"class","flex items-center justify-between py-2 border-b border-terminal-border")},m(r,m){u(r,t,m),d(t,n),d(n,i),d(i,o),d(o,s),d(o,l),d(o,a),d(i,c),N&&N.m(i,null),d(n,p),d(n,h),d(h,w),d(w,k),d(w,$),d(h,C),d(h,T),d(T,L),d(T,E),d(T,z),d(t,O),J[A].m(t,null),D=!0,I||(U=[x(w,"click",e[4]),x(T,"click",e[3])],I=!0)},p(e,[n]){(!D||2&n)&&P!==(P=e[1].length+"")&&v(l,P),e[0]?N?N.p(e,n):(N=$n(e),N.c(),N.m(i,null)):N&&(N.d(1),N=null),(!D||2&n&&j!==(j=0===e[1].length))&&(w.disabled=j),(!D||4&n&&M!==(M=e[2]?"mdi:loading":"mdi:refresh"))&&y(L,"icon",M),(!D||4&n)&&S(L,"animate-spin",e[2]),(!D||4&n)&&R!==(R=e[2]?"Refreshing...":"Refresh")&&v(z,R),(!D||4&n)&&(T.disabled=e[2]);let r=A;A=W(e),A===r?J[A].p(e,n):(G(),V(J[r],1,1,()=>{J[r]=null}),H(),F=J[A],F?F.p(e,n):(F=J[A]=B[A](e),F.c()),q(F,1),F.m(t,null))},i(e){D||(q(F),D=!0)},o(e){V(F),D=!1},d(e){e&&m(t),N&&N.d(),J[A].d(),I=!1,r(U)}}}const Ln=e=>"processing"===e.status||"uploaded"===e.status||"awaiting_upload"===e.status;function Mn(e,t,n){let r,i;a(e,de,e=>n(1,i=e));let o=!1,s=null;var c;function d(){s||n(5,s=setInterval(async()=>{if(r)try{await Pe()}catch(e){console.error("Auto-refresh failed:",e)}},3e3))}function u(){s&&(clearInterval(s),n(5,s=null))}return M(()=>{d()}),c=()=>{u()},L().$$.on_destroy.push(c),e.$$.update=()=>{2&e.$$.dirty&&n(0,r=i.some(e=>"processing"===e.status||"uploaded"===e.status||"awaiting_upload"===e.status)),33&e.$$.dirty&&(r?d():!r&&s&&setTimeout(()=>{r||u()},1e4))},[r,i,o,async function(){n(2,o=!0);try{await Pe(),setTimeout(()=>n(2,o=!1),1500)}catch(e){console.error("Refresh failed:",e),n(2,o=!1)}},async function(){if(confirm("Are you sure you want to delete all jobs? This action cannot be undone."))try{await async function(){const e=l(de);if(0===e.length)return;ae.info("delete","Starting delete all jobs operation",{total_jobs:e.length});const t=e.filter(e=>"streaming"===e.processing_method),n=e.filter(e=>"streaming"!==e.processing_method);if(de.set([]),t.length>0&&(ae.info("delete","Deleting streaming jobs from server (background)",{count:t.length}),t.forEach(e=>{fetch("/delete-job",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({job_id:e.job_id})}).catch(t=>{ae.debug("Background streaming job deletion failed (expected for local-only jobs)",{job_id:e.job_id,error:t.message})})})),n.length>0){ae.info("delete","Deleting server jobs",{count:n.length});const e=n.map(e=>fetch("/delete-job",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({job_id:e.job_id})}).catch(t=>(ae.error("Failed to delete server job",t,{job_id:e.job_id}),null)));await Promise.allSettled(e)}ae.complete("Delete all jobs completed",{streaming_jobs:t.length,server_jobs:n.length,total:e.length})}(),console.log("All jobs deleted from API.")}catch(e){console.error("Failed to delete all jobs:",e)}},s]}class En extends ne{constructor(e){super(),te(this,e,Mn,Tn,o,{})}}function zn(t){let n;return{c(){n=f("div"),n.innerHTML='<div class="text-md text-terminal-text-dim mb-2">Groq Whisper XL - Universal Audio Transcription Tool</div> <div class="flex justify-center"><a href="https://groq.com" target="_blank" rel="noopener noreferrer"><img class="w-40 mt-8" src="https://console.groq.com/powered-by-groq.svg" alt="Powered by Groq for fast inference."/></a></div>',_(n,"class","mt-4 p-3 text-center")},m(e,t){u(e,n,t)},p:e,i:e,o:e,d(e){e&&m(n)}}}class On extends ne{constructor(e){super(),te(this,e,null,zn,o,{})}}function An(t){let n,r,i,o,s,l,a,c,p,b;return r=new ie({}),o=new Vt({}),l=new En({}),p=new On({}),{c(){n=f("main"),Q(r.$$.fragment),i=g(),Q(o.$$.fragment),s=g(),Q(l.$$.fragment),a=g(),c=f("div"),Q(p.$$.fragment),_(n,"class","max-w-6xl mx-auto p-5 bg-terminal-bg-light"),_(c,"class","mb-8")},m(e,t){u(e,n,t),Y(r,n,null),d(n,i),Y(o,n,null),d(n,s),Y(l,n,null),u(e,a,t),u(e,c,t),Y(p,c,null),b=!0},p:e,i(e){b||(q(r.$$.fragment,e),q(o.$$.fragment,e),q(l.$$.fragment,e),q(p.$$.fragment,e),b=!0)},o(e){V(r.$$.fragment,e),V(o.$$.fragment,e),V(l.$$.fragment,e),V(p.$$.fragment,e),b=!1},d(e){e&&(m(n),m(a),m(c)),Z(r),Z(o),Z(l),Z(p)}}}function Fn(e){return M(()=>{Pe()}),[]}return new class extends ne{constructor(e){super(),te(this,e,Fn,An,o,{})}}({target:document.getElementById("app")})}();
`
};
